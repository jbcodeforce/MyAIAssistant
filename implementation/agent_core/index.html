<!DOCTYPE html>
<html class="no-js" lang="en"> <head><meta charset="utf-8"/><meta content="width=device-width,initial-scale=1" name="viewport"/><meta content="Intelligent Todo and Knowledge Management System" name="description"/><link href="https://jeromeboyer.net/myaiassistant/implementation/agent_core/" rel="canonical"/><link href="../assets/" rel="prev"/><link href="../agents/" rel="next"/><link href="../../assets/images/favicon.png" rel="icon"/><meta content="mkdocs-1.6.1, mkdocs-material-9.7.3" name="generator"/><title>Agent Core - MyAIAssistant Documentation</title><link href="../../assets/stylesheets/main.484c7ddc.min.css" rel="stylesheet"/><link href="../../assets/stylesheets/palette.ab4e12ef.min.css" rel="stylesheet"/><link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/><link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,300i,400,400i,700,700i%7CFira+Code:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/><style>:root{--md-text-font:"Source Sans Pro";--md-code-font:"Fira Code"}</style><link href="../../assets/_mkdocstrings.css" rel="stylesheet"/><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body data-md-color-accent="amber" data-md-color-primary="deep-purple" data-md-color-scheme="slate" dir="ltr"> <input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/> <input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/> <label class="md-overlay" for="__drawer"></label> <div data-md-component="skip"> <a class="md-skip" href="#agent-core-library"> Skip to content </a> </div> <div data-md-component="announce"> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component="header"> <nav aria-label="Header" class="md-header__inner md-grid"> <a aria-label="MyAIAssistant Documentation" class="md-header__button md-logo" data-md-component="logo" href="../.." title="MyAIAssistant Documentation"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg> </a> <label class="md-header__button md-icon" for="__drawer"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg> </label> <div class="md-header__title" data-md-component="header-title"> <div class="md-header__ellipsis"> <div class="md-header__topic"> <span class="md-ellipsis"> MyAIAssistant Documentation </span> </div> <div class="md-header__topic" data-md-component="header-topic"> <span class="md-ellipsis"> Agent Core </span> </div> </div> </div> <form class="md-header__option" data-md-component="palette"> <input aria-label="Switch to light mode" class="md-option" data-md-color-accent="amber" data-md-color-media="" data-md-color-primary="deep-purple" data-md-color-scheme="slate" id="__palette_0" name="__palette" type="radio"/> <label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to light mode"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg> </label> <input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="amber" data-md-color-media="" data-md-color-primary="deep-purple" data-md-color-scheme="default" id="__palette_1" name="__palette" type="radio"/> <label class="md-header__button md-icon" for="__palette_0" hidden="" title="Switch to dark mode"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for="__search"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg> </label> <div class="md-search" data-md-component="search" role="dialog"> <label class="md-search__overlay" for="__search"></label> <div class="md-search__inner" role="search"> <form class="md-search__form" name="search"> <input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/> <label class="md-search__icon md-icon" for="__search"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg> </label> <nav aria-label="Search" class="md-search__options"> <button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg> </button> </nav> <div class="md-search__suggest" data-md-component="search-suggest"></div> </form> <div class="md-search__output"> <div class="md-search__scrollwrap" data-md-scrollfix="" tabindex="0"> <div class="md-search-result" data-md-component="search-result"> <div class="md-search-result__meta"> Initializing search </div> <ol class="md-search-result__list" role="presentation"></ol> </div> </div> </div> </div> </div> <div class="md-header__source"> <a class="md-source" data-md-component="source" href="https://github.com/jbcodeforce/myaiassistant" title="Go to repository"> <div class="md-source__icon md-icon"> <svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"></path></svg> </div> <div class="md-source__repository"> GitHub </div> </a> </div> </nav> <nav aria-label="Tabs" class="md-tabs" data-md-component="tabs"> <div class="md-grid"> <ul class="md-tabs__list"> <li class="md-tabs__item"> <a class="md-tabs__link" href="../.."> Home </a> </li> <li class="md-tabs__item"> <a class="md-tabs__link" href="../../user_guide/"> User Guide </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a class="md-tabs__link" href="../"> Implementation </a> </li> <li class="md-tabs__item"> <a class="md-tabs__link" href="../../deployment/"> Deployment </a> </li> </ul> </div> </nav> </header> <div class="md-container" data-md-component="container"> <main class="md-main" data-md-component="main"> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation"> <div class="md-sidebar__scrollwrap"> <div class="md-sidebar__inner"> <nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted" data-md-level="0"> <label class="md-nav__title" for="__drawer"> <a aria-label="MyAIAssistant Documentation" class="md-nav__button md-logo" data-md-component="logo" href="../.." title="MyAIAssistant Documentation"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg> </a> MyAIAssistant Documentation </label> <div class="md-nav__source"> <a class="md-source" data-md-component="source" href="https://github.com/jbcodeforce/myaiassistant" title="Go to repository"> <div class="md-source__icon md-icon"> <svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"></path></svg> </div> <div class="md-source__repository"> GitHub </div> </a> </div> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../.."> <span class="md-ellipsis"> Home </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_2" type="checkbox"/> <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0"> <span class="md-ellipsis"> User Guide </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_2_label" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_2"> <span class="md-nav__icon md-icon"></span> User Guide </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../user_guide/"> <span class="md-ellipsis"> Overview </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../user_guide/getting-started.md"> <span class="md-ellipsis"> Getting started (ai_assist CLI) </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../user_guide/tasks/"> <span class="md-ellipsis"> Task management </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../user_guide/organizations/"> <span class="md-ellipsis"> Organization management </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../user_guide/projects/"> <span class="md-ellipsis"> Project management </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../user_guide/assets/"> <span class="md-ellipsis"> Assets management </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../user_guide/knowledge/"> <span class="md-ellipsis"> Knowledge Mgt </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../user_guide/agents/"> <span class="md-ellipsis"> Agents management </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../commands/"> <span class="md-ellipsis"> Commands </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input checked="" class="md-nav__toggle md-toggle" id="__nav_3" type="checkbox"/> <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex=""> <span class="md-ellipsis"> Implementation </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="true" aria-labelledby="__nav_3_label" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_3"> <span class="md-nav__icon md-icon"></span> Implementation </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../"> <span class="md-ellipsis"> Overview </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../todo/"> <span class="md-ellipsis"> Todo Management </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../knowledge/"> <span class="md-ellipsis"> Knowledge Base </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../meetings/"> <span class="md-ellipsis"> Meeting Notes </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../assets/"> <span class="md-ellipsis"> Assets </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/> <label class="md-nav__link md-nav__link--active" for="__toc"> <span class="md-ellipsis"> Agent Core </span> <span class="md-nav__icon md-icon"></span> </label> <a class="md-nav__link md-nav__link--active" href="./"> <span class="md-ellipsis"> Agent Core </span> </a> <nav aria-label="Table of contents" class="md-nav md-nav--secondary"> <label class="md-nav__title" for="__toc"> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="#architecture-overview"> <span class="md-ellipsis"> Architecture Overview </span> </a> <nav aria-label="Architecture Overview" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#query-execution-flow"> <span class="md-ellipsis"> Query Execution Flow </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#class-relationships"> <span class="md-ellipsis"> Class Relationships </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#core-components"> <span class="md-ellipsis"> Core Components </span> </a> <nav aria-label="Core Components" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#agent-factory"> <span class="md-ellipsis"> Agent Factory </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#agent-configuration"> <span class="md-ellipsis"> Agent Configuration </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#base-agent"> <span class="md-ellipsis"> Base Agent </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#query-classifier"> <span class="md-ellipsis"> Query Classifier </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#agent-router"> <span class="md-ellipsis"> Agent Router </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#rag-integration"> <span class="md-ellipsis"> RAG Integration </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#data-models"> <span class="md-ellipsis"> Data Models </span> </a> <nav aria-label="Data Models" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#agentinput"> <span class="md-ellipsis"> AgentInput </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#agentresponse"> <span class="md-ellipsis"> AgentResponse </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#routedresponse"> <span class="md-ellipsis"> RoutedResponse </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#extending-agent-core"> <span class="md-ellipsis"> Extending Agent Core </span> </a> <nav aria-label="Extending Agent Core" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#creating-custom-agents"> <span class="md-ellipsis"> Creating Custom Agents </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#adding-new-query-intents"> <span class="md-ellipsis"> Adding New Query Intents </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#extending-rag-service"> <span class="md-ellipsis"> Extending RAG Service </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#custom-llm-provider"> <span class="md-ellipsis"> Custom LLM Provider </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#workflow-examples"> <span class="md-ellipsis"> Workflow Examples </span> </a> <nav aria-label="Workflow Examples" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#simple-agent-execution"> <span class="md-ellipsis"> Simple Agent Execution </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#rag-enabled-agent"> <span class="md-ellipsis"> RAG-Enabled Agent </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#router-with-custom-agents"> <span class="md-ellipsis"> Router with Custom Agents </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#context-aware-agent"> <span class="md-ellipsis"> Context-Aware Agent </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#testing"> <span class="md-ellipsis"> Testing </span> </a> <nav aria-label="Testing" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#unit-testing-agents"> <span class="md-ellipsis"> Unit Testing Agents </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#testing-router"> <span class="md-ellipsis"> Testing Router </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#mocking-rag-service"> <span class="md-ellipsis"> Mocking RAG Service </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#best-practices"> <span class="md-ellipsis"> Best Practices </span> </a> <nav aria-label="Best Practices" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#agent-design"> <span class="md-ellipsis"> Agent Design </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#configuration-management"> <span class="md-ellipsis"> Configuration Management </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#rag-integration_1"> <span class="md-ellipsis"> RAG Integration </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#performance"> <span class="md-ellipsis"> Performance </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#troubleshooting"> <span class="md-ellipsis"> Troubleshooting </span> </a> <nav aria-label="Troubleshooting" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#agent-not-found"> <span class="md-ellipsis"> Agent Not Found </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#class-import-error"> <span class="md-ellipsis"> Class Import Error </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#rag-not-working"> <span class="md-ellipsis"> RAG Not Working </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#prompt-not-loading"> <span class="md-ellipsis"> Prompt Not Loading </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#api-reference"> <span class="md-ellipsis"> API Reference </span> </a> <nav aria-label="API Reference" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#factory-functions"> <span class="md-ellipsis"> Factory Functions </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#agent-classes"> <span class="md-ellipsis"> Agent Classes </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#router"> <span class="md-ellipsis"> Router </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#query-classification"> <span class="md-ellipsis"> Query Classification </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#rag-service"> <span class="md-ellipsis"> RAG Service </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../agents/"> <span class="md-ellipsis"> Agent mgt </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../rag/"> <span class="md-ellipsis"> RAG System </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../chat/"> <span class="md-ellipsis"> Chat </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../frontend/"> <span class="md-ellipsis"> Frontend </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_4" type="checkbox"/> <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0"> <span class="md-ellipsis"> Deployment </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_4_label" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_4"> <span class="md-nav__icon md-icon"></span> Deployment </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../deployment/"> <span class="md-ellipsis"> Overview </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../deployment/docker/"> <span class="md-ellipsis"> Docker </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../deployment/cloud/"> <span class="md-ellipsis"> Cloud Providers </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../deployment/configuration/"> <span class="md-ellipsis"> Configuration </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc"> <div class="md-sidebar__scrollwrap"> <div class="md-sidebar__inner"> <nav aria-label="Table of contents" class="md-nav md-nav--secondary"> <label class="md-nav__title" for="__toc"> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="#architecture-overview"> <span class="md-ellipsis"> Architecture Overview </span> </a> <nav aria-label="Architecture Overview" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#query-execution-flow"> <span class="md-ellipsis"> Query Execution Flow </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#class-relationships"> <span class="md-ellipsis"> Class Relationships </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#core-components"> <span class="md-ellipsis"> Core Components </span> </a> <nav aria-label="Core Components" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#agent-factory"> <span class="md-ellipsis"> Agent Factory </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#agent-configuration"> <span class="md-ellipsis"> Agent Configuration </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#base-agent"> <span class="md-ellipsis"> Base Agent </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#query-classifier"> <span class="md-ellipsis"> Query Classifier </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#agent-router"> <span class="md-ellipsis"> Agent Router </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#rag-integration"> <span class="md-ellipsis"> RAG Integration </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#data-models"> <span class="md-ellipsis"> Data Models </span> </a> <nav aria-label="Data Models" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#agentinput"> <span class="md-ellipsis"> AgentInput </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#agentresponse"> <span class="md-ellipsis"> AgentResponse </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#routedresponse"> <span class="md-ellipsis"> RoutedResponse </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#extending-agent-core"> <span class="md-ellipsis"> Extending Agent Core </span> </a> <nav aria-label="Extending Agent Core" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#creating-custom-agents"> <span class="md-ellipsis"> Creating Custom Agents </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#adding-new-query-intents"> <span class="md-ellipsis"> Adding New Query Intents </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#extending-rag-service"> <span class="md-ellipsis"> Extending RAG Service </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#custom-llm-provider"> <span class="md-ellipsis"> Custom LLM Provider </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#workflow-examples"> <span class="md-ellipsis"> Workflow Examples </span> </a> <nav aria-label="Workflow Examples" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#simple-agent-execution"> <span class="md-ellipsis"> Simple Agent Execution </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#rag-enabled-agent"> <span class="md-ellipsis"> RAG-Enabled Agent </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#router-with-custom-agents"> <span class="md-ellipsis"> Router with Custom Agents </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#context-aware-agent"> <span class="md-ellipsis"> Context-Aware Agent </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#testing"> <span class="md-ellipsis"> Testing </span> </a> <nav aria-label="Testing" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#unit-testing-agents"> <span class="md-ellipsis"> Unit Testing Agents </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#testing-router"> <span class="md-ellipsis"> Testing Router </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#mocking-rag-service"> <span class="md-ellipsis"> Mocking RAG Service </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#best-practices"> <span class="md-ellipsis"> Best Practices </span> </a> <nav aria-label="Best Practices" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#agent-design"> <span class="md-ellipsis"> Agent Design </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#configuration-management"> <span class="md-ellipsis"> Configuration Management </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#rag-integration_1"> <span class="md-ellipsis"> RAG Integration </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#performance"> <span class="md-ellipsis"> Performance </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#troubleshooting"> <span class="md-ellipsis"> Troubleshooting </span> </a> <nav aria-label="Troubleshooting" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#agent-not-found"> <span class="md-ellipsis"> Agent Not Found </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#class-import-error"> <span class="md-ellipsis"> Class Import Error </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#rag-not-working"> <span class="md-ellipsis"> RAG Not Working </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#prompt-not-loading"> <span class="md-ellipsis"> Prompt Not Loading </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#api-reference"> <span class="md-ellipsis"> API Reference </span> </a> <nav aria-label="API Reference" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#factory-functions"> <span class="md-ellipsis"> Factory Functions </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#agent-classes"> <span class="md-ellipsis"> Agent Classes </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#router"> <span class="md-ellipsis"> Router </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#query-classification"> <span class="md-ellipsis"> Query Classification </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#rag-service"> <span class="md-ellipsis"> RAG Service </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-content" data-md-component="content"> <article class="md-content__inner md-typeset"> <h1 id="agent-core-library">Agent Core Library<a class="headerlink" href="#agent-core-library" title="Permanent link">¶</a></h1> <p>The <code>agent_core</code> library provides a config-driven framework for building agentic AI applications with unified LLM integration, intelligent query routing, and RAG capabilities.</p> <h2 id="architecture-overview">Architecture Overview<a class="headerlink" href="#architecture-overview" title="Permanent link">¶</a></h2> <p>The agent core follows a modular architecture with clear separation of concerns:</p> <pre class="mermaid"><code>graph TB
    subgraph "Agent Router"
        Router[AgentRouter]
        Classifier[QueryClassifier]
        IntentMap[Intent Mapping]
        Router --&gt; Classifier
        Classifier --&gt; IntentMap
    end

    subgraph "Agent Factory"
        Factory[AgentFactory]
        ConfigDiscovery[YAML Config Discovery]
        ClassResolution[Agent Class Resolution]
        Factory --&gt; ConfigDiscovery
        ConfigDiscovery --&gt; ClassResolution
    end

    subgraph "Base Agent"
        BaseAgent[BaseAgent]
        PromptBuilder[System Prompt Builder]
        RAGIntegration[RAG Integration]
        LLMClient[LLM Client]
        BaseAgent --&gt; PromptBuilder
        BaseAgent --&gt; RAGIntegration
        BaseAgent --&gt; LLMClient
    end

    subgraph "RAG Service"
        RAGService[RAGService]
        DocLoader[Document Loader]
        VectorStore[Vector Store]
        EmbeddingModel[Embedding Model]
        RAGService --&gt; DocLoader
        RAGService --&gt; VectorStore
        RAGService --&gt; EmbeddingModel
    end

    Router --&gt; Factory
    Factory --&gt; BaseAgent
    RAGIntegration --&gt; RAGService

    style Router fill:#e1f5ff
    style Factory fill:#fff4e1
    style BaseAgent fill:#e8f5e9
    style RAGService fill:#fce4ec
</code></pre> <h3 id="query-execution-flow">Query Execution Flow<a class="headerlink" href="#query-execution-flow" title="Permanent link">¶</a></h3> <p>The following sequence diagram illustrates how a query flows through the agent core system:</p> <pre class="mermaid"><code>sequenceDiagram
    participant User
    participant Router as AgentRouter
    participant Classifier as QueryClassifier
    participant Factory as AgentFactory
    participant Agent as BaseAgent
    participant RAG as RAGService
    participant LLM as LLM Client
    participant VectorStore as Vector Store

    User-&gt;&gt;Router: route(query, history, context)

    Note over Router: Step 1: Classification
    Router-&gt;&gt;Classifier: execute(AgentInput)
    Classifier-&gt;&gt;LLM: chat_async(messages)
    LLM--&gt;&gt;Classifier: response
    Classifier-&gt;&gt;Classifier: parse JSON classification
    Classifier--&gt;&gt;Router: ClassificationResult

    Note over Router: Step 2: Agent Selection
    Router-&gt;&gt;Factory: create_agent(agent_name)
    Factory-&gt;&gt;Factory: load agent.yaml &amp; prompt.md
    Factory-&gt;&gt;Factory: resolve agent class
    Factory-&gt;&gt;Agent: __init__(config)
    Factory--&gt;&gt;Router: Agent instance

    Note over Router: Step 3: Agent Execution
    Router-&gt;&gt;Agent: execute(AgentInput)

    alt RAG enabled
        Agent-&gt;&gt;RAG: search(query, filters)
        RAG-&gt;&gt;VectorStore: query embeddings
        VectorStore--&gt;&gt;RAG: search results
        RAG--&gt;&gt;Agent: list[SearchResult]
        Agent-&gt;&gt;Agent: format_rag_context()
    end

    Agent-&gt;&gt;Agent: build_system_prompt(context)
    Agent-&gt;&gt;Agent: build_messages()
    Agent-&gt;&gt;LLM: chat_async(messages)
    LLM--&gt;&gt;Agent: LLMResponse
    Agent-&gt;&gt;Agent: create AgentResponse
    Agent--&gt;&gt;Router: AgentResponse

    Note over Router: Step 4: Build Response
    Router-&gt;&gt;Router: _build_response(state)
    Router--&gt;&gt;User: RoutedResponse
</code></pre> <h3 id="class-relationships">Class Relationships<a class="headerlink" href="#class-relationships" title="Permanent link">¶</a></h3> <p>The following class diagram shows the relationships between core classes:</p> <pre class="mermaid"><code>classDiagram
    class AgentConfig {
        +str name
        +str description
        +str agent_class
        +str model
        +str provider
        +str base_url
        +float temperature
        +int max_tokens
        +bool use_rag
        +int rag_top_k
        +from_yaml(Path) AgentConfig
        +validate() void
    }

    class AgentFactory {
        -Dict[str, AgentConfig] _configs
        +__init__(config_dir, load_defaults)
        +list_agents() list[str]
        +get_agent_map(name) AgentConfig
        +create_agent(name) BaseAgent
        -_discover_agents() Dict
        -_resolve_agent_class(class_name) Type
        -_load_default_agents_from_resources() Dict
    }

    class BaseAgent {
        +str agent_type
        -AgentConfig _config
        -LLMClient _llm_client
        -str _system_prompt
        +execute(AgentInput) AgentResponse
        +build_system_prompt(context) str
        -_build_messages(input_data) Tuple
        -_retrieve_rag_context(query, context) list[dict]
        -_format_rag_context(results) str
    }

    class QueryClassifier {
        +str agent_type
        +execute(AgentInput) ClassificationResult
        -_parse_response(response_text) ClassificationResult
    }

    class AgentRouter {
        -QueryClassifier classifier
        -Dict[str, BaseAgent] agents
        -Dict[QueryIntent, str] intent_mapping
        +route(query, history, context) RoutedResponse
        +register_agent(agent_type, agent) void
        +add_intent_mapping(intent, agent_type) void
        -_classify_step(state) WorkflowState
        -_route_step(state) WorkflowState
        -_build_response(state) RoutedResponse
    }

    class RAGService {
        -DocumentProcessor document_processor
        -VectorStore vector_store
        -DocumentLoader document_loader
        +index_knowledge(knowledge_id, ...) IndexingResult
        +search(query, n_results, ...) list[SearchResult]
        +remove_knowledge(knowledge_id) bool
        +get_collection_stats() dict
    }

    class AgentInput {
        +str query
        +list[dict] conversation_history
        +dict context
        +Optional[bool] use_rag
    }

    class AgentResponse {
        +str message
        +list[dict] context_used
        +str agent_type
        +dict metadata
    }

    class RoutedResponse {
        +str message
        +list[dict] context_used
        +QueryIntent intent
        +float confidence
        +str agent_type
        +str classification_reasoning
        +dict metadata
    }

    class ClassificationResult {
        +QueryIntent intent
        +float confidence
        +str reasoning
        +dict entities
        +Optional[str] suggested_context
    }

    class QueryIntent {
        &lt;<enumeration>&gt;
        KNOWLEDGE_SEARCH
        TASK_PLANNING
        TASK_STATUS
        CODE_HELP
        GENERAL_CHAT
        MEETING_NOTE
        RESEARCH
        UNCLEAR
    }

    BaseAgent &lt;|-- QueryClassifier
    AgentFactory --&gt; AgentConfig : uses
    AgentFactory --&gt; BaseAgent : creates
    BaseAgent --&gt; AgentConfig : uses
    BaseAgent --&gt; AgentInput : accepts
    BaseAgent --&gt; AgentResponse : returns
    BaseAgent ..&gt; RAGService : uses
    AgentRouter --&gt; QueryClassifier : uses
    AgentRouter --&gt; BaseAgent : routes to
    AgentRouter --&gt; RoutedResponse : returns
    QueryClassifier --&gt; ClassificationResult : returns
    ClassificationResult --&gt; QueryIntent : uses
    RAGService --&gt; SearchResult : returns
    RAGService --&gt; IndexingResult : returns
</enumeration></code></pre> <h2 id="core-components">Core Components<a class="headerlink" href="#core-components" title="Permanent link">¶</a></h2> <h3 id="agent-factory">Agent Factory<a class="headerlink" href="#agent-factory" title="Permanent link">¶</a></h3> <p>The <code>AgentFactory</code> discovers and creates agents from YAML configuration files. It supports both filesystem-based and package resource-based agent definitions.</p> <p><strong>Key Features:</strong> - Automatic discovery of agents from configuration directories - Support for default agents shipped as package resources - Dynamic class loading from fully qualified names - Generic agent support (no Python code required)</p> <p><strong>Usage:</strong></p> <div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a href="#__codelineno-0-1" id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">agent_core.agents.agent_factory</span><span class="w"> </span><span class="kn">import</span> <span class="n">AgentFactory</span><span class="p">,</span> <span class="n">get_agent_factory</span>
</span><span id="__span-0-2"><a href="#__codelineno-0-2" id="__codelineno-0-2" name="__codelineno-0-2"></a>
</span><span id="__span-0-3"><a href="#__codelineno-0-3" id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="c1"># Create factory with custom config directory</span>
</span><span id="__span-0-4"><a href="#__codelineno-0-4" id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="n">factory</span> <span class="o">=</span> <span class="n">AgentFactory</span><span class="p">(</span><span class="n">config_dir</span><span class="o">=</span><span class="s2">"/path/to/agent/configs"</span><span class="p">)</span>
</span><span id="__span-0-5"><a href="#__codelineno-0-5" id="__codelineno-0-5" name="__codelineno-0-5"></a>
</span><span id="__span-0-6"><a href="#__codelineno-0-6" id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="c1"># Or use singleton</span>
</span><span id="__span-0-7"><a href="#__codelineno-0-7" id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="n">factory</span> <span class="o">=</span> <span class="n">get_agent_factory</span><span class="p">()</span>
</span><span id="__span-0-8"><a href="#__codelineno-0-8" id="__codelineno-0-8" name="__codelineno-0-8"></a>
</span><span id="__span-0-9"><a href="#__codelineno-0-9" id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="c1"># List available agents</span>
</span><span id="__span-0-10"><a href="#__codelineno-0-10" id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="n">agents</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">list_agents</span><span class="p">()</span>
</span><span id="__span-0-11"><a href="#__codelineno-0-11" id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="c1"># ['QueryClassifier', 'GeneralAgent', 'CodeAgent', 'TaskAgent']</span>
</span><span id="__span-0-12"><a href="#__codelineno-0-12" id="__codelineno-0-12" name="__codelineno-0-12"></a>
</span><span id="__span-0-13"><a href="#__codelineno-0-13" id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="c1"># Create an agent</span>
</span><span id="__span-0-14"><a href="#__codelineno-0-14" id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="n">agent</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">create_agent</span><span class="p">(</span><span class="s2">"GeneralAgent"</span><span class="p">)</span>
</span></code></pre></div> <p><strong>Configuration Discovery:</strong></p> <p>The factory loads agents in two phases:</p> <ol> <li><strong>Default Agents</strong>: Loaded from package resources (<code>agent_core.agents.config</code>)</li> <li><strong>User Agents</strong>: Loaded from filesystem config directory (overrides defaults)</li> </ol> <p>Each agent is defined by a directory containing: - <code>agent.yaml</code> - Agent configuration - <code>prompt.md</code> - System prompt template (optional)</p> <h3 id="agent-configuration">Agent Configuration<a class="headerlink" href="#agent-configuration" title="Permanent link">¶</a></h3> <p>Agents are configured via YAML files using the <code>AgentConfig</code> model:</p> <div class="language-yaml highlight"><pre><span></span><code><span id="__span-1-1"><a href="#__codelineno-1-1" id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">GeneralAgent</span>
</span><span id="__span-1-2"><a href="#__codelineno-1-2" id="__codelineno-1-2" name="__codelineno-1-2"></a><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">General purpose assistant</span>
</span><span id="__span-1-3"><a href="#__codelineno-1-3" id="__codelineno-1-3" name="__codelineno-1-3"></a><span class="nt">class</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">agent_core.agents.base_agent.BaseAgent</span><span class="w">  </span><span class="c1"># Optional</span>
</span><span id="__span-1-4"><a href="#__codelineno-1-4" id="__codelineno-1-4" name="__codelineno-1-4"></a><span class="nt">model</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mistral:7b-instruct</span>
</span><span id="__span-1-5"><a href="#__codelineno-1-5" id="__codelineno-1-5" name="__codelineno-1-5"></a><span class="nt">provider</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">huggingface</span>
</span><span id="__span-1-6"><a href="#__codelineno-1-6" id="__codelineno-1-6" name="__codelineno-1-6"></a><span class="nt">base_url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://localhost:11434/v1</span>
</span><span id="__span-1-7"><a href="#__codelineno-1-7" id="__codelineno-1-7" name="__codelineno-1-7"></a><span class="nt">temperature</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.7</span>
</span><span id="__span-1-8"><a href="#__codelineno-1-8" id="__codelineno-1-8" name="__codelineno-1-8"></a><span class="nt">max_tokens</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4096</span>
</span><span id="__span-1-9"><a href="#__codelineno-1-9" id="__codelineno-1-9" name="__codelineno-1-9"></a><span class="nt">use_rag</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
</span><span id="__span-1-10"><a href="#__codelineno-1-10" id="__codelineno-1-10" name="__codelineno-1-10"></a><span class="nt">rag_top_k</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
</span><span id="__span-1-11"><a href="#__codelineno-1-11" id="__codelineno-1-11" name="__codelineno-1-11"></a><span class="nt">rag_category</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
</span></code></pre></div> <p><strong>Configuration Fields:</strong></p> <table> <thead> <tr> <th>Field</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>name</code></td> <td>string</td> <td>Agent name (matches directory name)</td> </tr> <tr> <td><code>description</code></td> <td>string</td> <td>Human-readable description</td> </tr> <tr> <td><code>class</code></td> <td>string</td> <td>Fully qualified Python class name (optional)</td> </tr> <tr> <td><code>model</code></td> <td>string</td> <td>Model identifier</td> </tr> <tr> <td><code>provider</code></td> <td>string</td> <td>LLM provider (currently always "huggingface")</td> </tr> <tr> <td><code>api_key</code></td> <td>string</td> <td>API key for remote models (optional)</td> </tr> <tr> <td><code>base_url</code></td> <td>string</td> <td>Base URL for local inference servers</td> </tr> <tr> <td><code>temperature</code></td> <td>float</td> <td>Sampling temperature (0.0-2.0)</td> </tr> <tr> <td><code>max_tokens</code></td> <td>int</td> <td>Maximum response tokens</td> </tr> <tr> <td><code>timeout</code></td> <td>float</td> <td>Request timeout in seconds</td> </tr> <tr> <td><code>use_rag</code></td> <td>bool</td> <td>Enable RAG for this agent</td> </tr> <tr> <td><code>rag_top_k</code></td> <td>int</td> <td>Number of RAG results to retrieve</td> </tr> <tr> <td><code>rag_category</code></td> <td>string</td> <td>Default category filter for RAG</td> </tr> </tbody> </table> <h3 id="base-agent">Base Agent<a class="headerlink" href="#base-agent" title="Permanent link">¶</a></h3> <p>The <code>BaseAgent</code> class provides the foundation for all agents. It handles:</p> <ul> <li>LLM client initialization</li> <li>System prompt loading and templating</li> <li>RAG context retrieval and formatting</li> <li>Message building for LLM calls</li> <li>Response formatting</li> </ul> <p><strong>Key Methods:</strong></p> <div class="language-python highlight"><pre><span></span><code><span id="__span-2-1"><a href="#__codelineno-2-1" id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">BaseAgent</span><span class="p">:</span>
</span><span id="__span-2-2"><a href="#__codelineno-2-2" id="__codelineno-2-2" name="__codelineno-2-2"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_data</span><span class="p">:</span> <span class="n">AgentInput</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AgentResponse</span><span class="p">:</span>
</span><span id="__span-2-3"><a href="#__codelineno-2-3" id="__codelineno-2-3" name="__codelineno-2-3"></a><span class="w">        </span><span class="sd">"""Execute the agent with input data."""</span>
</span><span id="__span-2-4"><a href="#__codelineno-2-4" id="__codelineno-2-4" name="__codelineno-2-4"></a>
</span><span id="__span-2-5"><a href="#__codelineno-2-5" id="__codelineno-2-5" name="__codelineno-2-5"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">build_system_prompt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="__span-2-6"><a href="#__codelineno-2-6" id="__codelineno-2-6" name="__codelineno-2-6"></a><span class="w">        </span><span class="sd">"""Build system prompt with optional context substitution."""</span>
</span><span id="__span-2-7"><a href="#__codelineno-2-7" id="__codelineno-2-7" name="__codelineno-2-7"></a>
</span><span id="__span-2-8"><a href="#__codelineno-2-8" id="__codelineno-2-8" name="__codelineno-2-8"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_retrieve_rag_context</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
</span><span id="__span-2-9"><a href="#__codelineno-2-9" id="__codelineno-2-9" name="__codelineno-2-9"></a><span class="w">        </span><span class="sd">"""Retrieve relevant context from RAG service."""</span>
</span><span id="__span-2-10"><a href="#__codelineno-2-10" id="__codelineno-2-10" name="__codelineno-2-10"></a>
</span><span id="__span-2-11"><a href="#__codelineno-2-11" id="__codelineno-2-11" name="__codelineno-2-11"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_format_rag_context</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">results</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="__span-2-12"><a href="#__codelineno-2-12" id="__codelineno-2-12" name="__codelineno-2-12"></a><span class="w">        </span><span class="sd">"""Format RAG results for LLM context."""</span>
</span></code></pre></div> <p><strong>System Prompt Templating:</strong></p> <p>Prompts support template variables using <code>{variable}</code> syntax:</p> <div class="language-markdown highlight"><pre><span></span><code><span id="__span-3-1"><a href="#__codelineno-3-1" id="__codelineno-3-1" name="__codelineno-3-1"></a>You are a {role} assistant.
</span><span id="__span-3-2"><a href="#__codelineno-3-2" id="__codelineno-3-2" name="__codelineno-3-2"></a>
</span><span id="__span-3-3"><a href="#__codelineno-3-3" id="__codelineno-3-3" name="__codelineno-3-3"></a><span class="gu">## Context</span>
</span><span id="__span-3-4"><a href="#__codelineno-3-4" id="__codelineno-3-4" name="__codelineno-3-4"></a>Current task: {task_name}
</span><span id="__span-3-5"><a href="#__codelineno-3-5" id="__codelineno-3-5" name="__codelineno-3-5"></a>Priority: {priority}
</span></code></pre></div> <p>Variables are substituted from the <code>context</code> dict passed to <code>execute()</code>:</p> <div class="language-python highlight"><pre><span></span><code><span id="__span-4-1"><a href="#__codelineno-4-1" id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="n">agent</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">AgentInput</span><span class="p">(</span>
</span><span id="__span-4-2"><a href="#__codelineno-4-2" id="__codelineno-4-2" name="__codelineno-4-2"></a>    <span class="n">query</span><span class="o">=</span><span class="s2">"Help me with this"</span><span class="p">,</span>
</span><span id="__span-4-3"><a href="#__codelineno-4-3" id="__codelineno-4-3" name="__codelineno-4-3"></a>    <span class="n">context</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-4-4"><a href="#__codelineno-4-4" id="__codelineno-4-4" name="__codelineno-4-4"></a>        <span class="s2">"role"</span><span class="p">:</span> <span class="s2">"code"</span><span class="p">,</span>
</span><span id="__span-4-5"><a href="#__codelineno-4-5" id="__codelineno-4-5" name="__codelineno-4-5"></a>        <span class="s2">"task_name"</span><span class="p">:</span> <span class="s2">"Implement OAuth"</span><span class="p">,</span>
</span><span id="__span-4-6"><a href="#__codelineno-4-6" id="__codelineno-4-6" name="__codelineno-4-6"></a>        <span class="s2">"priority"</span><span class="p">:</span> <span class="s2">"high"</span>
</span><span id="__span-4-7"><a href="#__codelineno-4-7" id="__codelineno-4-7" name="__codelineno-4-7"></a>    <span class="p">}</span>
</span><span id="__span-4-8"><a href="#__codelineno-4-8" id="__codelineno-4-8" name="__codelineno-4-8"></a><span class="p">))</span>
</span></code></pre></div> <h3 id="query-classifier">Query Classifier<a class="headerlink" href="#query-classifier" title="Permanent link">¶</a></h3> <p>The <code>QueryClassifier</code> analyzes user queries to determine intent for routing:</p> <div class="language-python highlight"><pre><span></span><code><span id="__span-5-1"><a href="#__codelineno-5-1" id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">agent_core.agents.query_classifier</span><span class="w"> </span><span class="kn">import</span> <span class="n">QueryClassifier</span><span class="p">,</span> <span class="n">QueryIntent</span>
</span><span id="__span-5-2"><a href="#__codelineno-5-2" id="__codelineno-5-2" name="__codelineno-5-2"></a>
</span><span id="__span-5-3"><a href="#__codelineno-5-3" id="__codelineno-5-3" name="__codelineno-5-3"></a><span class="n">classifier</span> <span class="o">=</span> <span class="n">QueryClassifier</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">agent_config</span><span class="p">)</span>
</span><span id="__span-5-4"><a href="#__codelineno-5-4" id="__codelineno-5-4" name="__codelineno-5-4"></a>
</span><span id="__span-5-5"><a href="#__codelineno-5-5" id="__codelineno-5-5" name="__codelineno-5-5"></a><span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">classifier</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">AgentInput</span><span class="p">(</span><span class="n">query</span><span class="o">=</span><span class="s2">"How do I implement OAuth?"</span><span class="p">))</span>
</span><span id="__span-5-6"><a href="#__codelineno-5-6" id="__codelineno-5-6" name="__codelineno-5-6"></a><span class="c1"># Returns ClassificationResult with:</span>
</span><span id="__span-5-7"><a href="#__codelineno-5-7" id="__codelineno-5-7" name="__codelineno-5-7"></a><span class="c1"># - intent: QueryIntent.CODE_HELP</span>
</span><span id="__span-5-8"><a href="#__codelineno-5-8" id="__codelineno-5-8" name="__codelineno-5-8"></a><span class="c1"># - confidence: 0.95</span>
</span><span id="__span-5-9"><a href="#__codelineno-5-9" id="__codelineno-5-9" name="__codelineno-5-9"></a><span class="c1"># - reasoning: "Query asks about implementation..."</span>
</span><span id="__span-5-10"><a href="#__codelineno-5-10" id="__codelineno-5-10" name="__codelineno-5-10"></a><span class="c1"># - entities: {"topic": "OAuth", "keywords": ["implement"]}</span>
</span></code></pre></div> <p><strong>Supported Intents:</strong></p> <table> <thead> <tr> <th>Intent</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>KNOWLEDGE_SEARCH</code></td> <td>Information retrieval from knowledge base</td> </tr> <tr> <td><code>TASK_PLANNING</code></td> <td>Task breakdown and planning</td> </tr> <tr> <td><code>TASK_STATUS</code></td> <td>Status of existing tasks</td> </tr> <tr> <td><code>CODE_HELP</code></td> <td>Programming assistance</td> </tr> <tr> <td><code>GENERAL_CHAT</code></td> <td>General conversation</td> </tr> <tr> <td><code>MEETING_NOTE</code></td> <td>Meeting note processing</td> </tr> <tr> <td><code>RESEARCH</code></td> <td>Research queries</td> </tr> <tr> <td><code>UNCLEAR</code></td> <td>Ambiguous queries needing clarification</td> </tr> </tbody> </table> <h3 id="agent-router">Agent Router<a class="headerlink" href="#agent-router" title="Permanent link">¶</a></h3> <p>The <code>AgentRouter</code> orchestrates the classification and routing workflow:</p> <ol> <li><strong>Classification</strong>: Determines query intent</li> <li><strong>Agent Selection</strong>: Maps intent to agent type</li> <li><strong>Execution</strong>: Runs selected agent</li> <li><strong>Response</strong>: Returns formatted response with metadata</li> </ol> <p><strong>Usage:</strong></p> <div class="language-python highlight"><pre><span></span><code><span id="__span-6-1"><a href="#__codelineno-6-1" id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">agent_core.agents.agent_router</span><span class="w"> </span><span class="kn">import</span> <span class="n">AgentRouter</span>
</span><span id="__span-6-2"><a href="#__codelineno-6-2" id="__codelineno-6-2" name="__codelineno-6-2"></a>
</span><span id="__span-6-3"><a href="#__codelineno-6-3" id="__codelineno-6-3" name="__codelineno-6-3"></a><span class="n">router</span> <span class="o">=</span> <span class="n">AgentRouter</span><span class="p">(</span><span class="n">config_dir</span><span class="o">=</span><span class="s2">"/path/to/configs"</span><span class="p">)</span>
</span><span id="__span-6-4"><a href="#__codelineno-6-4" id="__codelineno-6-4" name="__codelineno-6-4"></a>
</span><span id="__span-6-5"><a href="#__codelineno-6-5" id="__codelineno-6-5" name="__codelineno-6-5"></a><span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="n">router</span><span class="o">.</span><span class="n">route</span><span class="p">(</span>
</span><span id="__span-6-6"><a href="#__codelineno-6-6" id="__codelineno-6-6" name="__codelineno-6-6"></a>    <span class="n">query</span><span class="o">=</span><span class="s2">"How do I implement OAuth?"</span><span class="p">,</span>
</span><span id="__span-6-7"><a href="#__codelineno-6-7" id="__codelineno-6-7" name="__codelineno-6-7"></a>    <span class="n">conversation_history</span><span class="o">=</span><span class="p">[],</span>
</span><span id="__span-6-8"><a href="#__codelineno-6-8" id="__codelineno-6-8" name="__codelineno-6-8"></a>    <span class="n">context</span><span class="o">=</span><span class="p">{}</span>
</span><span id="__span-6-9"><a href="#__codelineno-6-9" id="__codelineno-6-9" name="__codelineno-6-9"></a><span class="p">)</span>
</span><span id="__span-6-10"><a href="#__codelineno-6-10" id="__codelineno-6-10" name="__codelineno-6-10"></a>
</span><span id="__span-6-11"><a href="#__codelineno-6-11" id="__codelineno-6-11" name="__codelineno-6-11"></a><span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">message</span><span class="p">)</span>           <span class="c1"># Agent response</span>
</span><span id="__span-6-12"><a href="#__codelineno-6-12" id="__codelineno-6-12" name="__codelineno-6-12"></a><span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">intent</span><span class="p">)</span>             <span class="c1"># QueryIntent.CODE_HELP</span>
</span><span id="__span-6-13"><a href="#__codelineno-6-13" id="__codelineno-6-13" name="__codelineno-6-13"></a><span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">agent_type</span><span class="p">)</span>         <span class="c1"># "code_help"</span>
</span><span id="__span-6-14"><a href="#__codelineno-6-14" id="__codelineno-6-14" name="__codelineno-6-14"></a><span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">confidence</span><span class="p">)</span>         <span class="c1"># 0.95</span>
</span><span id="__span-6-15"><a href="#__codelineno-6-15" id="__codelineno-6-15" name="__codelineno-6-15"></a><span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">classification_reasoning</span><span class="p">)</span>  <span class="c1"># "Query asks about..."</span>
</span></code></pre></div> <p><strong>Default Intent Mapping:</strong></p> <div class="language-python highlight"><pre><span></span><code><span id="__span-7-1"><a href="#__codelineno-7-1" id="__codelineno-7-1" name="__codelineno-7-1"></a><span class="n">DEFAULT_INTENT_MAPPING</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-7-2"><a href="#__codelineno-7-2" id="__codelineno-7-2" name="__codelineno-7-2"></a>    <span class="n">QueryIntent</span><span class="o">.</span><span class="n">KNOWLEDGE_SEARCH</span><span class="p">:</span> <span class="s2">"knowledge_search"</span><span class="p">,</span>
</span><span id="__span-7-3"><a href="#__codelineno-7-3" id="__codelineno-7-3" name="__codelineno-7-3"></a>    <span class="n">QueryIntent</span><span class="o">.</span><span class="n">TASK_PLANNING</span><span class="p">:</span> <span class="s2">"task_planning"</span><span class="p">,</span>
</span><span id="__span-7-4"><a href="#__codelineno-7-4" id="__codelineno-7-4" name="__codelineno-7-4"></a>    <span class="n">QueryIntent</span><span class="o">.</span><span class="n">TASK_STATUS</span><span class="p">:</span> <span class="s2">"task_status"</span><span class="p">,</span>
</span><span id="__span-7-5"><a href="#__codelineno-7-5" id="__codelineno-7-5" name="__codelineno-7-5"></a>    <span class="n">QueryIntent</span><span class="o">.</span><span class="n">CODE_HELP</span><span class="p">:</span> <span class="s2">"code_help"</span><span class="p">,</span>
</span><span id="__span-7-6"><a href="#__codelineno-7-6" id="__codelineno-7-6" name="__codelineno-7-6"></a>    <span class="n">QueryIntent</span><span class="o">.</span><span class="n">GENERAL_CHAT</span><span class="p">:</span> <span class="s2">"general_chat"</span><span class="p">,</span>
</span><span id="__span-7-7"><a href="#__codelineno-7-7" id="__codelineno-7-7" name="__codelineno-7-7"></a>    <span class="n">QueryIntent</span><span class="o">.</span><span class="n">UNCLEAR</span><span class="p">:</span> <span class="s2">"unclear"</span><span class="p">,</span>
</span><span id="__span-7-8"><a href="#__codelineno-7-8" id="__codelineno-7-8" name="__codelineno-7-8"></a><span class="p">}</span>
</span></code></pre></div> <p><strong>Custom Routing:</strong></p> <div class="language-python highlight"><pre><span></span><code><span id="__span-8-1"><a href="#__codelineno-8-1" id="__codelineno-8-1" name="__codelineno-8-1"></a><span class="n">router</span> <span class="o">=</span> <span class="n">AgentRouter</span><span class="p">()</span>
</span><span id="__span-8-2"><a href="#__codelineno-8-2" id="__codelineno-8-2" name="__codelineno-8-2"></a>
</span><span id="__span-8-3"><a href="#__codelineno-8-3" id="__codelineno-8-3" name="__codelineno-8-3"></a><span class="c1"># Register custom agent</span>
</span><span id="__span-8-4"><a href="#__codelineno-8-4" id="__codelineno-8-4" name="__codelineno-8-4"></a><span class="n">router</span><span class="o">.</span><span class="n">register_agent</span><span class="p">(</span><span class="s2">"custom_agent"</span><span class="p">,</span> <span class="n">my_custom_agent</span><span class="p">)</span>
</span><span id="__span-8-5"><a href="#__codelineno-8-5" id="__codelineno-8-5" name="__codelineno-8-5"></a>
</span><span id="__span-8-6"><a href="#__codelineno-8-6" id="__codelineno-8-6" name="__codelineno-8-6"></a><span class="c1"># Map intent to agent</span>
</span><span id="__span-8-7"><a href="#__codelineno-8-7" id="__codelineno-8-7" name="__codelineno-8-7"></a><span class="n">router</span><span class="o">.</span><span class="n">add_intent_mapping</span><span class="p">(</span><span class="n">QueryIntent</span><span class="o">.</span><span class="n">RESEARCH</span><span class="p">,</span> <span class="s2">"custom_agent"</span><span class="p">)</span>
</span></code></pre></div> <h3 id="rag-integration">RAG Integration<a class="headerlink" href="#rag-integration" title="Permanent link">¶</a></h3> <p>Agents can use RAG by setting <code>use_rag: true</code> in their configuration or passing <code>use_rag=True</code> in the input:</p> <div class="language-python highlight"><pre><span></span><code><span id="__span-9-1"><a href="#__codelineno-9-1" id="__codelineno-9-1" name="__codelineno-9-1"></a><span class="c1"># Enable RAG in agent config</span>
</span><span id="__span-9-2"><a href="#__codelineno-9-2" id="__codelineno-9-2" name="__codelineno-9-2"></a><span class="n">config</span> <span class="o">=</span> <span class="n">AgentConfig</span><span class="p">(</span>
</span><span id="__span-9-3"><a href="#__codelineno-9-3" id="__codelineno-9-3" name="__codelineno-9-3"></a>    <span class="n">name</span><span class="o">=</span><span class="s2">"RAGAgent"</span><span class="p">,</span>
</span><span id="__span-9-4"><a href="#__codelineno-9-4" id="__codelineno-9-4" name="__codelineno-9-4"></a>    <span class="n">use_rag</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="__span-9-5"><a href="#__codelineno-9-5" id="__codelineno-9-5" name="__codelineno-9-5"></a>    <span class="n">rag_top_k</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
</span><span id="__span-9-6"><a href="#__codelineno-9-6" id="__codelineno-9-6" name="__codelineno-9-6"></a>    <span class="n">rag_category</span><span class="o">=</span><span class="s2">"Engineering"</span>
</span><span id="__span-9-7"><a href="#__codelineno-9-7" id="__codelineno-9-7" name="__codelineno-9-7"></a><span class="p">)</span>
</span><span id="__span-9-8"><a href="#__codelineno-9-8" id="__codelineno-9-8" name="__codelineno-9-8"></a>
</span><span id="__span-9-9"><a href="#__codelineno-9-9" id="__codelineno-9-9" name="__codelineno-9-9"></a><span class="c1"># Or override per-request</span>
</span><span id="__span-9-10"><a href="#__codelineno-9-10" id="__codelineno-9-10" name="__codelineno-9-10"></a><span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="n">agent</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">AgentInput</span><span class="p">(</span>
</span><span id="__span-9-11"><a href="#__codelineno-9-11" id="__codelineno-9-11" name="__codelineno-9-11"></a>    <span class="n">query</span><span class="o">=</span><span class="s2">"How to configure database?"</span><span class="p">,</span>
</span><span id="__span-9-12"><a href="#__codelineno-9-12" id="__codelineno-9-12" name="__codelineno-9-12"></a>    <span class="n">use_rag</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="__span-9-13"><a href="#__codelineno-9-13" id="__codelineno-9-13" name="__codelineno-9-13"></a>    <span class="n">context</span><span class="o">=</span><span class="p">{</span><span class="s2">"rag_category"</span><span class="p">:</span> <span class="s2">"DevOps"</span><span class="p">}</span>
</span><span id="__span-9-14"><a href="#__codelineno-9-14" id="__codelineno-9-14" name="__codelineno-9-14"></a><span class="p">))</span>
</span></code></pre></div> <p><strong>RAG Context Flow:</strong></p> <ol> <li>Agent calls <code>_retrieve_rag_context(query, context)</code></li> <li>RAG service searches vector store with filters</li> <li>Results formatted and added to system messages</li> <li>LLM receives query with retrieved context</li> </ol> <p><strong>RAG Context Format:</strong></p> <div class="language-python highlight"><pre><span></span><code><span id="__span-10-1"><a href="#__codelineno-10-1" id="__codelineno-10-1" name="__codelineno-10-1"></a><span class="p">[</span>
</span><span id="__span-10-2"><a href="#__codelineno-10-2" id="__codelineno-10-2" name="__codelineno-10-2"></a>    <span class="p">{</span>
</span><span id="__span-10-3"><a href="#__codelineno-10-3" id="__codelineno-10-3" name="__codelineno-10-3"></a>        <span class="s2">"content"</span><span class="p">:</span> <span class="s2">"Document content..."</span><span class="p">,</span>
</span><span id="__span-10-4"><a href="#__codelineno-10-4" id="__codelineno-10-4" name="__codelineno-10-4"></a>        <span class="s2">"title"</span><span class="p">:</span> <span class="s2">"Document Title"</span><span class="p">,</span>
</span><span id="__span-10-5"><a href="#__codelineno-10-5" id="__codelineno-10-5" name="__codelineno-10-5"></a>        <span class="s2">"uri"</span><span class="p">:</span> <span class="s2">"/path/to/doc.md"</span><span class="p">,</span>
</span><span id="__span-10-6"><a href="#__codelineno-10-6" id="__codelineno-10-6" name="__codelineno-10-6"></a>        <span class="s2">"score"</span><span class="p">:</span> <span class="mf">0.87</span><span class="p">,</span>
</span><span id="__span-10-7"><a href="#__codelineno-10-7" id="__codelineno-10-7" name="__codelineno-10-7"></a>        <span class="s2">"knowledge_id"</span><span class="p">:</span> <span class="mi">123</span>
</span><span id="__span-10-8"><a href="#__codelineno-10-8" id="__codelineno-10-8" name="__codelineno-10-8"></a>    <span class="p">}</span>
</span><span id="__span-10-9"><a href="#__codelineno-10-9" id="__codelineno-10-9" name="__codelineno-10-9"></a><span class="p">]</span>
</span></code></pre></div> <h2 id="data-models">Data Models<a class="headerlink" href="#data-models" title="Permanent link">¶</a></h2> <h3 id="agentinput">AgentInput<a class="headerlink" href="#agentinput" title="Permanent link">¶</a></h3> <p>Standard input structure for agent execution:</p> <div class="language-python highlight"><pre><span></span><code><span id="__span-11-1"><a href="#__codelineno-11-1" id="__codelineno-11-1" name="__codelineno-11-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">AgentInput</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
</span><span id="__span-11-2"><a href="#__codelineno-11-2" id="__codelineno-11-2" name="__codelineno-11-2"></a>    <span class="n">query</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-11-3"><a href="#__codelineno-11-3" id="__codelineno-11-3" name="__codelineno-11-3"></a>    <span class="n">conversation_history</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
</span><span id="__span-11-4"><a href="#__codelineno-11-4" id="__codelineno-11-4" name="__codelineno-11-4"></a>    <span class="n">context</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
</span><span id="__span-11-5"><a href="#__codelineno-11-5" id="__codelineno-11-5" name="__codelineno-11-5"></a>    <span class="n">use_rag</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Override agent's RAG setting</span>
</span></code></pre></div> <h3 id="agentresponse">AgentResponse<a class="headerlink" href="#agentresponse" title="Permanent link">¶</a></h3> <p>Standard response structure:</p> <div class="language-python highlight"><pre><span></span><code><span id="__span-12-1"><a href="#__codelineno-12-1" id="__codelineno-12-1" name="__codelineno-12-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">AgentResponse</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
</span><span id="__span-12-2"><a href="#__codelineno-12-2" id="__codelineno-12-2" name="__codelineno-12-2"></a>    <span class="n">message</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-12-3"><a href="#__codelineno-12-3" id="__codelineno-12-3" name="__codelineno-12-3"></a>    <span class="n">context_used</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
</span><span id="__span-12-4"><a href="#__codelineno-12-4" id="__codelineno-12-4" name="__codelineno-12-4"></a>    <span class="n">agent_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">""</span>
</span><span id="__span-12-5"><a href="#__codelineno-12-5" id="__codelineno-12-5" name="__codelineno-12-5"></a>    <span class="n">metadata</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
</span></code></pre></div> <h3 id="routedresponse">RoutedResponse<a class="headerlink" href="#routedresponse" title="Permanent link">¶</a></h3> <p>Response from the router with classification metadata:</p> <div class="language-python highlight"><pre><span></span><code><span id="__span-13-1"><a href="#__codelineno-13-1" id="__codelineno-13-1" name="__codelineno-13-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">RoutedResponse</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
</span><span id="__span-13-2"><a href="#__codelineno-13-2" id="__codelineno-13-2" name="__codelineno-13-2"></a>    <span class="n">message</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-13-3"><a href="#__codelineno-13-3" id="__codelineno-13-3" name="__codelineno-13-3"></a>    <span class="n">context_used</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span>
</span><span id="__span-13-4"><a href="#__codelineno-13-4" id="__codelineno-13-4" name="__codelineno-13-4"></a>    <span class="n">intent</span><span class="p">:</span> <span class="n">QueryIntent</span>
</span><span id="__span-13-5"><a href="#__codelineno-13-5" id="__codelineno-13-5" name="__codelineno-13-5"></a>    <span class="n">confidence</span><span class="p">:</span> <span class="nb">float</span>
</span><span id="__span-13-6"><a href="#__codelineno-13-6" id="__codelineno-13-6" name="__codelineno-13-6"></a>    <span class="n">agent_type</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-13-7"><a href="#__codelineno-13-7" id="__codelineno-13-7" name="__codelineno-13-7"></a>    <span class="n">classification_reasoning</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-13-8"><a href="#__codelineno-13-8" id="__codelineno-13-8" name="__codelineno-13-8"></a>    <span class="n">metadata</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
</span></code></pre></div> <h2 id="extending-agent-core">Extending Agent Core<a class="headerlink" href="#extending-agent-core" title="Permanent link">¶</a></h2> <h3 id="creating-custom-agents">Creating Custom Agents<a class="headerlink" href="#creating-custom-agents" title="Permanent link">¶</a></h3> <h4 id="method-1-generic-agent-yaml-only">Method 1: Generic Agent (YAML-only)<a class="headerlink" href="#method-1-generic-agent-yaml-only" title="Permanent link">¶</a></h4> <p>Create an agent without writing Python code:</p> <ol> <li>Create agent directory:</li> </ol> <div class="language-text highlight"><pre><span></span><code><span id="__span-14-1"><a href="#__codelineno-14-1" id="__codelineno-14-1" name="__codelineno-14-1"></a>agent_core/agents/config/MyCustomAgent/
</span><span id="__span-14-2"><a href="#__codelineno-14-2" id="__codelineno-14-2" name="__codelineno-14-2"></a>├── agent.yaml
</span><span id="__span-14-3"><a href="#__codelineno-14-3" id="__codelineno-14-3" name="__codelineno-14-3"></a>└── prompt.md
</span></code></pre></div> <ol> <li>Define <code>agent.yaml</code>:</li> </ol> <div class="language-yaml highlight"><pre><span></span><code><span id="__span-15-1"><a href="#__codelineno-15-1" id="__codelineno-15-1" name="__codelineno-15-1"></a><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MyCustomAgent</span>
</span><span id="__span-15-2"><a href="#__codelineno-15-2" id="__codelineno-15-2" name="__codelineno-15-2"></a><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Custom agent for specific domain</span>
</span><span id="__span-15-3"><a href="#__codelineno-15-3" id="__codelineno-15-3" name="__codelineno-15-3"></a><span class="c1"># class field omitted - uses BaseAgent</span>
</span><span id="__span-15-4"><a href="#__codelineno-15-4" id="__codelineno-15-4" name="__codelineno-15-4"></a><span class="nt">model</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mistral:7b-instruct</span>
</span><span id="__span-15-5"><a href="#__codelineno-15-5" id="__codelineno-15-5" name="__codelineno-15-5"></a><span class="nt">temperature</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.7</span>
</span><span id="__span-15-6"><a href="#__codelineno-15-6" id="__codelineno-15-6" name="__codelineno-15-6"></a><span class="nt">max_tokens</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2048</span>
</span><span id="__span-15-7"><a href="#__codelineno-15-7" id="__codelineno-15-7" name="__codelineno-15-7"></a><span class="nt">use_rag</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-15-8"><a href="#__codelineno-15-8" id="__codelineno-15-8" name="__codelineno-15-8"></a><span class="nt">rag_top_k</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
</span></code></pre></div> <ol> <li>Create <code>prompt.md</code>:</li> </ol> <div class="language-markdown highlight"><pre><span></span><code><span id="__span-16-1"><a href="#__codelineno-16-1" id="__codelineno-16-1" name="__codelineno-16-1"></a>You are a specialized assistant for {domain}.
</span><span id="__span-16-2"><a href="#__codelineno-16-2" id="__codelineno-16-2" name="__codelineno-16-2"></a>
</span><span id="__span-16-3"><a href="#__codelineno-16-3" id="__codelineno-16-3" name="__codelineno-16-3"></a><span class="gu">## Instructions</span>
</span><span id="__span-16-4"><a href="#__codelineno-16-4" id="__codelineno-16-4" name="__codelineno-16-4"></a><span class="k">-</span><span class="w"> </span>Provide accurate and helpful responses
</span><span id="__span-16-5"><a href="#__codelineno-16-5" id="__codelineno-16-5" name="__codelineno-16-5"></a><span class="k">-</span><span class="w"> </span>Use the context provided to inform your answers
</span><span id="__span-16-6"><a href="#__codelineno-16-6" id="__codelineno-16-6" name="__codelineno-16-6"></a><span class="k">-</span><span class="w"> </span>Focus on {domain} best practices
</span></code></pre></div> <ol> <li>Use the agent:</li> </ol> <div class="language-python highlight"><pre><span></span><code><span id="__span-17-1"><a href="#__codelineno-17-1" id="__codelineno-17-1" name="__codelineno-17-1"></a><span class="n">factory</span> <span class="o">=</span> <span class="n">AgentFactory</span><span class="p">()</span>
</span><span id="__span-17-2"><a href="#__codelineno-17-2" id="__codelineno-17-2" name="__codelineno-17-2"></a><span class="n">agent</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">create_agent</span><span class="p">(</span><span class="s2">"MyCustomAgent"</span><span class="p">)</span>
</span><span id="__span-17-3"><a href="#__codelineno-17-3" id="__codelineno-17-3" name="__codelineno-17-3"></a>
</span><span id="__span-17-4"><a href="#__codelineno-17-4" id="__codelineno-17-4" name="__codelineno-17-4"></a><span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="n">agent</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">AgentInput</span><span class="p">(</span>
</span><span id="__span-17-5"><a href="#__codelineno-17-5" id="__codelineno-17-5" name="__codelineno-17-5"></a>    <span class="n">query</span><span class="o">=</span><span class="s2">"Help with my domain question"</span><span class="p">,</span>
</span><span id="__span-17-6"><a href="#__codelineno-17-6" id="__codelineno-17-6" name="__codelineno-17-6"></a>    <span class="n">context</span><span class="o">=</span><span class="p">{</span><span class="s2">"domain"</span><span class="p">:</span> <span class="s2">"machine learning"</span><span class="p">}</span>
</span><span id="__span-17-7"><a href="#__codelineno-17-7" id="__codelineno-17-7" name="__codelineno-17-7"></a><span class="p">))</span>
</span></code></pre></div> <h4 id="method-2-custom-python-class">Method 2: Custom Python Class<a class="headerlink" href="#method-2-custom-python-class" title="Permanent link">¶</a></h4> <p>For agents requiring custom logic, extend <code>BaseAgent</code>:</p> <ol> <li>Create Python class:</li> </ol> <div class="language-python highlight"><pre><span></span><code><span id="__span-18-1"><a href="#__codelineno-18-1" id="__codelineno-18-1" name="__codelineno-18-1"></a><span class="c1"># my_package/agents.py</span>
</span><span id="__span-18-2"><a href="#__codelineno-18-2" id="__codelineno-18-2" name="__codelineno-18-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">agent_core.agents.base_agent</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseAgent</span><span class="p">,</span> <span class="n">AgentInput</span><span class="p">,</span> <span class="n">AgentResponse</span>
</span><span id="__span-18-3"><a href="#__codelineno-18-3" id="__codelineno-18-3" name="__codelineno-18-3"></a>
</span><span id="__span-18-4"><a href="#__codelineno-18-4" id="__codelineno-18-4" name="__codelineno-18-4"></a><span class="k">class</span><span class="w"> </span><span class="nc">MyCustomAgent</span><span class="p">(</span><span class="n">BaseAgent</span><span class="p">):</span>
</span><span id="__span-18-5"><a href="#__codelineno-18-5" id="__codelineno-18-5" name="__codelineno-18-5"></a>    <span class="n">agent_type</span> <span class="o">=</span> <span class="s2">"my_custom"</span>
</span><span id="__span-18-6"><a href="#__codelineno-18-6" id="__codelineno-18-6" name="__codelineno-18-6"></a>
</span><span id="__span-18-7"><a href="#__codelineno-18-7" id="__codelineno-18-7" name="__codelineno-18-7"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_data</span><span class="p">:</span> <span class="n">AgentInput</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AgentResponse</span><span class="p">:</span>
</span><span id="__span-18-8"><a href="#__codelineno-18-8" id="__codelineno-18-8" name="__codelineno-18-8"></a>        <span class="c1"># Custom preprocessing</span>
</span><span id="__span-18-9"><a href="#__codelineno-18-9" id="__codelineno-18-9" name="__codelineno-18-9"></a>        <span class="n">processed_query</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_preprocess_query</span><span class="p">(</span><span class="n">input_data</span><span class="o">.</span><span class="n">query</span><span class="p">)</span>
</span><span id="__span-18-10"><a href="#__codelineno-18-10" id="__codelineno-18-10" name="__codelineno-18-10"></a>
</span><span id="__span-18-11"><a href="#__codelineno-18-11" id="__codelineno-18-11" name="__codelineno-18-11"></a>        <span class="c1"># Build custom messages</span>
</span><span id="__span-18-12"><a href="#__codelineno-18-12" id="__codelineno-18-12" name="__codelineno-18-12"></a>        <span class="n">messages</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_messages</span><span class="p">(</span><span class="n">AgentInput</span><span class="p">(</span>
</span><span id="__span-18-13"><a href="#__codelineno-18-13" id="__codelineno-18-13" name="__codelineno-18-13"></a>            <span class="n">query</span><span class="o">=</span><span class="n">processed_query</span><span class="p">,</span>
</span><span id="__span-18-14"><a href="#__codelineno-18-14" id="__codelineno-18-14" name="__codelineno-18-14"></a>            <span class="n">conversation_history</span><span class="o">=</span><span class="n">input_data</span><span class="o">.</span><span class="n">conversation_history</span><span class="p">,</span>
</span><span id="__span-18-15"><a href="#__codelineno-18-15" id="__codelineno-18-15" name="__codelineno-18-15"></a>            <span class="n">context</span><span class="o">=</span><span class="n">input_data</span><span class="o">.</span><span class="n">context</span>
</span><span id="__span-18-16"><a href="#__codelineno-18-16" id="__codelineno-18-16" name="__codelineno-18-16"></a>        <span class="p">))</span>
</span><span id="__span-18-17"><a href="#__codelineno-18-17" id="__codelineno-18-17" name="__codelineno-18-17"></a>
</span><span id="__span-18-18"><a href="#__codelineno-18-18" id="__codelineno-18-18" name="__codelineno-18-18"></a>        <span class="c1"># Call LLM</span>
</span><span id="__span-18-19"><a href="#__codelineno-18-19" id="__codelineno-18-19" name="__codelineno-18-19"></a>        <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_llm_client</span><span class="o">.</span><span class="n">chat_async</span><span class="p">(</span>
</span><span id="__span-18-20"><a href="#__codelineno-18-20" id="__codelineno-18-20" name="__codelineno-18-20"></a>            <span class="n">messages</span><span class="o">=</span><span class="n">messages</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> 
</span><span id="__span-18-21"><a href="#__codelineno-18-21" id="__codelineno-18-21" name="__codelineno-18-21"></a>            <span class="n">config</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span>
</span><span id="__span-18-22"><a href="#__codelineno-18-22" id="__codelineno-18-22" name="__codelineno-18-22"></a>        <span class="p">)</span>
</span><span id="__span-18-23"><a href="#__codelineno-18-23" id="__codelineno-18-23" name="__codelineno-18-23"></a>
</span><span id="__span-18-24"><a href="#__codelineno-18-24" id="__codelineno-18-24" name="__codelineno-18-24"></a>        <span class="c1"># Post-process response</span>
</span><span id="__span-18-25"><a href="#__codelineno-18-25" id="__codelineno-18-25" name="__codelineno-18-25"></a>        <span class="n">formatted_message</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_response</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
</span><span id="__span-18-26"><a href="#__codelineno-18-26" id="__codelineno-18-26" name="__codelineno-18-26"></a>
</span><span id="__span-18-27"><a href="#__codelineno-18-27" id="__codelineno-18-27" name="__codelineno-18-27"></a>        <span class="k">return</span> <span class="n">AgentResponse</span><span class="p">(</span>
</span><span id="__span-18-28"><a href="#__codelineno-18-28" id="__codelineno-18-28" name="__codelineno-18-28"></a>            <span class="n">message</span><span class="o">=</span><span class="n">formatted_message</span><span class="p">,</span>
</span><span id="__span-18-29"><a href="#__codelineno-18-29" id="__codelineno-18-29" name="__codelineno-18-29"></a>            <span class="n">agent_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">agent_type</span><span class="p">,</span>
</span><span id="__span-18-30"><a href="#__codelineno-18-30" id="__codelineno-18-30" name="__codelineno-18-30"></a>            <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="s2">"preprocessed"</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
</span><span id="__span-18-31"><a href="#__codelineno-18-31" id="__codelineno-18-31" name="__codelineno-18-31"></a>        <span class="p">)</span>
</span><span id="__span-18-32"><a href="#__codelineno-18-32" id="__codelineno-18-32" name="__codelineno-18-32"></a>
</span><span id="__span-18-33"><a href="#__codelineno-18-33" id="__codelineno-18-33" name="__codelineno-18-33"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_preprocess_query</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="__span-18-34"><a href="#__codelineno-18-34" id="__codelineno-18-34" name="__codelineno-18-34"></a><span class="w">        </span><span class="sd">"""Custom query preprocessing."""</span>
</span><span id="__span-18-35"><a href="#__codelineno-18-35" id="__codelineno-18-35" name="__codelineno-18-35"></a>        <span class="k">return</span> <span class="n">query</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>  <span class="c1"># Example</span>
</span><span id="__span-18-36"><a href="#__codelineno-18-36" id="__codelineno-18-36" name="__codelineno-18-36"></a>
</span><span id="__span-18-37"><a href="#__codelineno-18-37" id="__codelineno-18-37" name="__codelineno-18-37"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_format_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">response</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="__span-18-38"><a href="#__codelineno-18-38" id="__codelineno-18-38" name="__codelineno-18-38"></a><span class="w">        </span><span class="sd">"""Custom response formatting."""</span>
</span><span id="__span-18-39"><a href="#__codelineno-18-39" id="__codelineno-18-39" name="__codelineno-18-39"></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">"[FORMATTED] </span><span class="si">{</span><span class="n">response</span><span class="si">}</span><span class="s2">"</span>
</span></code></pre></div> <ol> <li>Register the class:</li> </ol> <div class="language-python highlight"><pre><span></span><code><span id="__span-19-1"><a href="#__codelineno-19-1" id="__codelineno-19-1" name="__codelineno-19-1"></a><span class="c1"># Option A: Use fully qualified name in YAML</span>
</span><span id="__span-19-2"><a href="#__codelineno-19-2" id="__codelineno-19-2" name="__codelineno-19-2"></a><span class="c1"># agent.yaml:</span>
</span><span id="__span-19-3"><a href="#__codelineno-19-3" id="__codelineno-19-3" name="__codelineno-19-3"></a><span class="c1"># class: my_package.agents.MyCustomAgent</span>
</span><span id="__span-19-4"><a href="#__codelineno-19-4" id="__codelineno-19-4" name="__codelineno-19-4"></a>
</span><span id="__span-19-5"><a href="#__codelineno-19-5" id="__codelineno-19-5" name="__codelineno-19-5"></a><span class="c1"># Option B: Register manually</span>
</span><span id="__span-19-6"><a href="#__codelineno-19-6" id="__codelineno-19-6" name="__codelineno-19-6"></a><span class="kn">from</span><span class="w"> </span><span class="nn">agent_core.agents.agent_factory</span><span class="w"> </span><span class="kn">import</span> <span class="n">AgentFactory</span>
</span><span id="__span-19-7"><a href="#__codelineno-19-7" id="__codelineno-19-7" name="__codelineno-19-7"></a><span class="kn">from</span><span class="w"> </span><span class="nn">my_package.agents</span><span class="w"> </span><span class="kn">import</span> <span class="n">MyCustomAgent</span>
</span><span id="__span-19-8"><a href="#__codelineno-19-8" id="__codelineno-19-8" name="__codelineno-19-8"></a>
</span><span id="__span-19-9"><a href="#__codelineno-19-9" id="__codelineno-19-9" name="__codelineno-19-9"></a><span class="n">AgentFactory</span><span class="o">.</span><span class="n">register_class</span><span class="p">(</span><span class="s2">"MyCustomAgent"</span><span class="p">,</span> <span class="n">MyCustomAgent</span><span class="p">)</span>
</span></code></pre></div> <ol> <li>Create <code>agent.yaml</code>:</li> </ol> <div class="language-yaml highlight"><pre><span></span><code><span id="__span-20-1"><a href="#__codelineno-20-1" id="__codelineno-20-1" name="__codelineno-20-1"></a><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MyCustomAgent</span>
</span><span id="__span-20-2"><a href="#__codelineno-20-2" id="__codelineno-20-2" name="__codelineno-20-2"></a><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Custom agent with specialized logic</span>
</span><span id="__span-20-3"><a href="#__codelineno-20-3" id="__codelineno-20-3" name="__codelineno-20-3"></a><span class="nt">class</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my_package.agents.MyCustomAgent</span>
</span><span id="__span-20-4"><a href="#__codelineno-20-4" id="__codelineno-20-4" name="__codelineno-20-4"></a><span class="nt">model</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mistral:7b-instruct</span>
</span><span id="__span-20-5"><a href="#__codelineno-20-5" id="__codelineno-20-5" name="__codelineno-20-5"></a><span class="nt">temperature</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.7</span>
</span></code></pre></div> <h4 id="method-3-override-specific-methods">Method 3: Override Specific Methods<a class="headerlink" href="#method-3-override-specific-methods" title="Permanent link">¶</a></h4> <p>Extend <code>BaseAgent</code> and override specific methods:</p> <div class="language-python highlight"><pre><span></span><code><span id="__span-21-1"><a href="#__codelineno-21-1" id="__codelineno-21-1" name="__codelineno-21-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">CustomRAGAgent</span><span class="p">(</span><span class="n">BaseAgent</span><span class="p">):</span>
</span><span id="__span-21-2"><a href="#__codelineno-21-2" id="__codelineno-21-2" name="__codelineno-21-2"></a>    <span class="n">agent_type</span> <span class="o">=</span> <span class="s2">"custom_rag"</span>
</span><span id="__span-21-3"><a href="#__codelineno-21-3" id="__codelineno-21-3" name="__codelineno-21-3"></a>
</span><span id="__span-21-4"><a href="#__codelineno-21-4" id="__codelineno-21-4" name="__codelineno-21-4"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_retrieve_rag_context</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
</span><span id="__span-21-5"><a href="#__codelineno-21-5" id="__codelineno-21-5" name="__codelineno-21-5"></a><span class="w">        </span><span class="sd">"""Custom RAG retrieval logic."""</span>
</span><span id="__span-21-6"><a href="#__codelineno-21-6" id="__codelineno-21-6" name="__codelineno-21-6"></a>        <span class="c1"># Add custom filtering</span>
</span><span id="__span-21-7"><a href="#__codelineno-21-7" id="__codelineno-21-7" name="__codelineno-21-7"></a>        <span class="n">category</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"category"</span><span class="p">,</span> <span class="s2">"default"</span><span class="p">)</span>
</span><span id="__span-21-8"><a href="#__codelineno-21-8" id="__codelineno-21-8" name="__codelineno-21-8"></a>
</span><span id="__span-21-9"><a href="#__codelineno-21-9" id="__codelineno-21-9" name="__codelineno-21-9"></a>        <span class="c1"># Call parent method with custom filters</span>
</span><span id="__span-21-10"><a href="#__codelineno-21-10" id="__codelineno-21-10" name="__codelineno-21-10"></a>        <span class="n">results</span> <span class="o">=</span> <span class="k">await</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_retrieve_rag_context</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="p">{</span>
</span><span id="__span-21-11"><a href="#__codelineno-21-11" id="__codelineno-21-11" name="__codelineno-21-11"></a>            <span class="o">**</span><span class="n">context</span><span class="p">,</span>
</span><span id="__span-21-12"><a href="#__codelineno-21-12" id="__codelineno-21-12" name="__codelineno-21-12"></a>            <span class="s2">"rag_category"</span><span class="p">:</span> <span class="n">category</span><span class="p">,</span>
</span><span id="__span-21-13"><a href="#__codelineno-21-13" id="__codelineno-21-13" name="__codelineno-21-13"></a>            <span class="s2">"rag_top_k"</span><span class="p">:</span> <span class="mi">10</span>  <span class="c1"># Override top_k</span>
</span><span id="__span-21-14"><a href="#__codelineno-21-14" id="__codelineno-21-14" name="__codelineno-21-14"></a>        <span class="p">})</span>
</span><span id="__span-21-15"><a href="#__codelineno-21-15" id="__codelineno-21-15" name="__codelineno-21-15"></a>
</span><span id="__span-21-16"><a href="#__codelineno-21-16" id="__codelineno-21-16" name="__codelineno-21-16"></a>        <span class="c1"># Post-process results</span>
</span><span id="__span-21-17"><a href="#__codelineno-21-17" id="__codelineno-21-17" name="__codelineno-21-17"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filter_results</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
</span><span id="__span-21-18"><a href="#__codelineno-21-18" id="__codelineno-21-18" name="__codelineno-21-18"></a>
</span><span id="__span-21-19"><a href="#__codelineno-21-19" id="__codelineno-21-19" name="__codelineno-21-19"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_filter_results</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">results</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
</span><span id="__span-21-20"><a href="#__codelineno-21-20" id="__codelineno-21-20" name="__codelineno-21-20"></a><span class="w">        </span><span class="sd">"""Filter results by custom criteria."""</span>
</span><span id="__span-21-21"><a href="#__codelineno-21-21" id="__codelineno-21-21" name="__codelineno-21-21"></a>        <span class="k">return</span> <span class="p">[</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">results</span> <span class="k">if</span> <span class="n">r</span><span class="p">[</span><span class="s2">"score"</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.8</span><span class="p">]</span>
</span></code></pre></div> <h3 id="adding-new-query-intents">Adding New Query Intents<a class="headerlink" href="#adding-new-query-intents" title="Permanent link">¶</a></h3> <ol> <li>Extend <code>QueryIntent</code> enum:</li> </ol> <div class="language-python highlight"><pre><span></span><code><span id="__span-22-1"><a href="#__codelineno-22-1" id="__codelineno-22-1" name="__codelineno-22-1"></a><span class="c1"># agent_core/agents/query_classifier.py</span>
</span><span id="__span-22-2"><a href="#__codelineno-22-2" id="__codelineno-22-2" name="__codelineno-22-2"></a><span class="k">class</span><span class="w"> </span><span class="nc">QueryIntent</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">Enum</span><span class="p">):</span>
</span><span id="__span-22-3"><a href="#__codelineno-22-3" id="__codelineno-22-3" name="__codelineno-22-3"></a>    <span class="c1"># ... existing intents ...</span>
</span><span id="__span-22-4"><a href="#__codelineno-22-4" id="__codelineno-22-4" name="__codelineno-22-4"></a>    <span class="n">CUSTOM_INTENT</span> <span class="o">=</span> <span class="s2">"custom_intent"</span>
</span></code></pre></div> <ol> <li>Update classifier prompt:</li> </ol> <p>The classifier's prompt should be updated to recognize the new intent. Edit <code>agent_core/agents/config/QueryClassifier/prompt.md</code>:</p> <div class="language-markdown highlight"><pre><span></span><code><span id="__span-23-1"><a href="#__codelineno-23-1" id="__codelineno-23-1" name="__codelineno-23-1"></a><span class="gu">## Intent Categories</span>
</span><span id="__span-23-2"><a href="#__codelineno-23-2" id="__codelineno-23-2" name="__codelineno-23-2"></a>
</span><span id="__span-23-3"><a href="#__codelineno-23-3" id="__codelineno-23-3" name="__codelineno-23-3"></a><span class="k">-</span><span class="w"> </span>custom_intent: Queries related to [description]
</span></code></pre></div> <ol> <li>Add intent mapping in router:</li> </ol> <div class="language-python highlight"><pre><span></span><code><span id="__span-24-1"><a href="#__codelineno-24-1" id="__codelineno-24-1" name="__codelineno-24-1"></a><span class="n">router</span> <span class="o">=</span> <span class="n">AgentRouter</span><span class="p">()</span>
</span><span id="__span-24-2"><a href="#__codelineno-24-2" id="__codelineno-24-2" name="__codelineno-24-2"></a><span class="n">router</span><span class="o">.</span><span class="n">add_intent_mapping</span><span class="p">(</span><span class="n">QueryIntent</span><span class="o">.</span><span class="n">CUSTOM_INTENT</span><span class="p">,</span> <span class="s2">"custom_agent"</span><span class="p">)</span>
</span></code></pre></div> <h3 id="extending-rag-service">Extending RAG Service<a class="headerlink" href="#extending-rag-service" title="Permanent link">¶</a></h3> <h4 id="custom-document-loader">Custom Document Loader<a class="headerlink" href="#custom-document-loader" title="Permanent link">¶</a></h4> <div class="language-python highlight"><pre><span></span><code><span id="__span-25-1"><a href="#__codelineno-25-1" id="__codelineno-25-1" name="__codelineno-25-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">agent_core.services.rag.document_loader</span><span class="w"> </span><span class="kn">import</span> <span class="n">DocumentLoader</span><span class="p">,</span> <span class="n">LoadedDocument</span>
</span><span id="__span-25-2"><a href="#__codelineno-25-2" id="__codelineno-25-2" name="__codelineno-25-2"></a>
</span><span id="__span-25-3"><a href="#__codelineno-25-3" id="__codelineno-25-3" name="__codelineno-25-3"></a><span class="k">class</span><span class="w"> </span><span class="nc">CustomDocumentLoader</span><span class="p">(</span><span class="n">DocumentLoader</span><span class="p">):</span>
</span><span id="__span-25-4"><a href="#__codelineno-25-4" id="__codelineno-25-4" name="__codelineno-25-4"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">document_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">LoadedDocument</span><span class="p">]:</span>
</span><span id="__span-25-5"><a href="#__codelineno-25-5" id="__codelineno-25-5" name="__codelineno-25-5"></a>        <span class="k">if</span> <span class="n">document_type</span> <span class="o">==</span> <span class="s2">"custom_type"</span><span class="p">:</span>
</span><span id="__span-25-6"><a href="#__codelineno-25-6" id="__codelineno-25-6" name="__codelineno-25-6"></a>            <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load_custom_type</span><span class="p">(</span><span class="n">uri</span><span class="p">)</span>
</span><span id="__span-25-7"><a href="#__codelineno-25-7" id="__codelineno-25-7" name="__codelineno-25-7"></a>        <span class="k">return</span> <span class="k">await</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">uri</span><span class="p">,</span> <span class="n">document_type</span><span class="p">)</span>
</span><span id="__span-25-8"><a href="#__codelineno-25-8" id="__codelineno-25-8" name="__codelineno-25-8"></a>
</span><span id="__span-25-9"><a href="#__codelineno-25-9" id="__codelineno-25-9" name="__codelineno-25-9"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_load_custom_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">LoadedDocument</span><span class="p">]:</span>
</span><span id="__span-25-10"><a href="#__codelineno-25-10" id="__codelineno-25-10" name="__codelineno-25-10"></a>        <span class="c1"># Custom loading logic</span>
</span><span id="__span-25-11"><a href="#__codelineno-25-11" id="__codelineno-25-11" name="__codelineno-25-11"></a>        <span class="n">content</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fetch_custom_content</span><span class="p">(</span><span class="n">uri</span><span class="p">)</span>
</span><span id="__span-25-12"><a href="#__codelineno-25-12" id="__codelineno-25-12" name="__codelineno-25-12"></a>        <span class="k">return</span> <span class="p">[</span><span class="n">LoadedDocument</span><span class="p">(</span>
</span><span id="__span-25-13"><a href="#__codelineno-25-13" id="__codelineno-25-13" name="__codelineno-25-13"></a>            <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>
</span><span id="__span-25-14"><a href="#__codelineno-25-14" id="__codelineno-25-14" name="__codelineno-25-14"></a>            <span class="n">document_id</span><span class="o">=</span><span class="sa">f</span><span class="s2">"custom_</span><span class="si">{</span><span class="n">uri</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span>
</span><span id="__span-25-15"><a href="#__codelineno-25-15" id="__codelineno-25-15" name="__codelineno-25-15"></a>            <span class="n">content_hash</span><span class="o">=</span><span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="n">content</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">(),</span>
</span><span id="__span-25-16"><a href="#__codelineno-25-16" id="__codelineno-25-16" name="__codelineno-25-16"></a>            <span class="n">source_uri</span><span class="o">=</span><span class="n">uri</span><span class="p">,</span>
</span><span id="__span-25-17"><a href="#__codelineno-25-17" id="__codelineno-25-17" name="__codelineno-25-17"></a>            <span class="n">title</span><span class="o">=</span><span class="s2">"Custom Document"</span>
</span><span id="__span-25-18"><a href="#__codelineno-25-18" id="__codelineno-25-18" name="__codelineno-25-18"></a>        <span class="p">)]</span>
</span></code></pre></div> <h4 id="custom-text-splitter">Custom Text Splitter<a class="headerlink" href="#custom-text-splitter" title="Permanent link">¶</a></h4> <div class="language-python highlight"><pre><span></span><code><span id="__span-26-1"><a href="#__codelineno-26-1" id="__codelineno-26-1" name="__codelineno-26-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">agent_core.services.rag.text_splitter</span><span class="w"> </span><span class="kn">import</span> <span class="n">RecursiveTextSplitter</span><span class="p">,</span> <span class="n">TextChunk</span>
</span><span id="__span-26-2"><a href="#__codelineno-26-2" id="__codelineno-26-2" name="__codelineno-26-2"></a>
</span><span id="__span-26-3"><a href="#__codelineno-26-3" id="__codelineno-26-3" name="__codelineno-26-3"></a><span class="k">class</span><span class="w"> </span><span class="nc">CustomTextSplitter</span><span class="p">(</span><span class="n">RecursiveTextSplitter</span><span class="p">):</span>
</span><span id="__span-26-4"><a href="#__codelineno-26-4" id="__codelineno-26-4" name="__codelineno-26-4"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">split_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">metadata</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">TextChunk</span><span class="p">]:</span>
</span><span id="__span-26-5"><a href="#__codelineno-26-5" id="__codelineno-26-5" name="__codelineno-26-5"></a>        <span class="c1"># Custom splitting logic</span>
</span><span id="__span-26-6"><a href="#__codelineno-26-6" id="__codelineno-26-6" name="__codelineno-26-6"></a>        <span class="c1"># For example, split by code blocks</span>
</span><span id="__span-26-7"><a href="#__codelineno-26-7" id="__codelineno-26-7" name="__codelineno-26-7"></a>        <span class="n">chunks</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-26-8"><a href="#__codelineno-26-8" id="__codelineno-26-8" name="__codelineno-26-8"></a>        <span class="n">code_blocks</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">'```[\s\S]*?```'</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
</span><span id="__span-26-9"><a href="#__codelineno-26-9" id="__codelineno-26-9" name="__codelineno-26-9"></a>
</span><span id="__span-26-10"><a href="#__codelineno-26-10" id="__codelineno-26-10" name="__codelineno-26-10"></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">block</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">code_blocks</span><span class="p">):</span>
</span><span id="__span-26-11"><a href="#__codelineno-26-11" id="__codelineno-26-11" name="__codelineno-26-11"></a>            <span class="n">chunks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">TextChunk</span><span class="p">(</span>
</span><span id="__span-26-12"><a href="#__codelineno-26-12" id="__codelineno-26-12" name="__codelineno-26-12"></a>                <span class="n">content</span><span class="o">=</span><span class="n">block</span><span class="p">,</span>
</span><span id="__span-26-13"><a href="#__codelineno-26-13" id="__codelineno-26-13" name="__codelineno-26-13"></a>                <span class="n">start_index</span><span class="o">=</span><span class="n">text</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">block</span><span class="p">),</span>
</span><span id="__span-26-14"><a href="#__codelineno-26-14" id="__codelineno-26-14" name="__codelineno-26-14"></a>                <span class="n">chunk_index</span><span class="o">=</span><span class="n">i</span><span class="p">,</span>
</span><span id="__span-26-15"><a href="#__codelineno-26-15" id="__codelineno-26-15" name="__codelineno-26-15"></a>                <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span> <span class="ow">or</span> <span class="p">{}</span>
</span><span id="__span-26-16"><a href="#__codelineno-26-16" id="__codelineno-26-16" name="__codelineno-26-16"></a>            <span class="p">))</span>
</span><span id="__span-26-17"><a href="#__codelineno-26-17" id="__codelineno-26-17" name="__codelineno-26-17"></a>
</span><span id="__span-26-18"><a href="#__codelineno-26-18" id="__codelineno-26-18" name="__codelineno-26-18"></a>        <span class="k">return</span> <span class="n">chunks</span>
</span></code></pre></div> <h4 id="custom-vector-store">Custom Vector Store<a class="headerlink" href="#custom-vector-store" title="Permanent link">¶</a></h4> <div class="language-python highlight"><pre><span></span><code><span id="__span-27-1"><a href="#__codelineno-27-1" id="__codelineno-27-1" name="__codelineno-27-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">agent_core.services.rag.vector_store</span><span class="w"> </span><span class="kn">import</span> <span class="n">VectorStore</span>
</span><span id="__span-27-2"><a href="#__codelineno-27-2" id="__codelineno-27-2" name="__codelineno-27-2"></a>
</span><span id="__span-27-3"><a href="#__codelineno-27-3" id="__codelineno-27-3" name="__codelineno-27-3"></a><span class="k">class</span><span class="w"> </span><span class="nc">CustomVectorStore</span><span class="p">(</span><span class="n">VectorStore</span><span class="p">):</span>
</span><span id="__span-27-4"><a href="#__codelineno-27-4" id="__codelineno-27-4" name="__codelineno-27-4"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">search</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SearchResults</span><span class="p">:</span>
</span><span id="__span-27-5"><a href="#__codelineno-27-5" id="__codelineno-27-5" name="__codelineno-27-5"></a>        <span class="c1"># Custom search logic</span>
</span><span id="__span-27-6"><a href="#__codelineno-27-6" id="__codelineno-27-6" name="__codelineno-27-6"></a>        <span class="c1"># For example, hybrid search combining vector and keyword search</span>
</span><span id="__span-27-7"><a href="#__codelineno-27-7" id="__codelineno-27-7" name="__codelineno-27-7"></a>        <span class="n">vector_results</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="__span-27-8"><a href="#__codelineno-27-8" id="__codelineno-27-8" name="__codelineno-27-8"></a>        <span class="n">keyword_results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_keyword_search</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="__span-27-9"><a href="#__codelineno-27-9" id="__codelineno-27-9" name="__codelineno-27-9"></a>
</span><span id="__span-27-10"><a href="#__codelineno-27-10" id="__codelineno-27-10" name="__codelineno-27-10"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_merge_results</span><span class="p">(</span><span class="n">vector_results</span><span class="p">,</span> <span class="n">keyword_results</span><span class="p">)</span>
</span></code></pre></div> <h3 id="custom-llm-provider">Custom LLM Provider<a class="headerlink" href="#custom-llm-provider" title="Permanent link">¶</a></h3> <p>The library uses a provider factory pattern. To add a custom provider:</p> <ol> <li>Create provider class:</li> </ol> <div class="language-python highlight"><pre><span></span><code><span id="__span-28-1"><a href="#__codelineno-28-1" id="__codelineno-28-1" name="__codelineno-28-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">agent_core.providers.llm_provider_base</span><span class="w"> </span><span class="kn">import</span> <span class="n">LLMProviderBase</span>
</span><span id="__span-28-2"><a href="#__codelineno-28-2" id="__codelineno-28-2" name="__codelineno-28-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">agent_core.types</span><span class="w"> </span><span class="kn">import</span> <span class="n">LLMResponse</span><span class="p">,</span> <span class="n">Message</span>
</span><span id="__span-28-3"><a href="#__codelineno-28-3" id="__codelineno-28-3" name="__codelineno-28-3"></a>
</span><span id="__span-28-4"><a href="#__codelineno-28-4" id="__codelineno-28-4" name="__codelineno-28-4"></a><span class="k">class</span><span class="w"> </span><span class="nc">CustomLLMProvider</span><span class="p">(</span><span class="n">LLMProviderBase</span><span class="p">):</span>
</span><span id="__span-28-5"><a href="#__codelineno-28-5" id="__codelineno-28-5" name="__codelineno-28-5"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">chat_async</span><span class="p">(</span>
</span><span id="__span-28-6"><a href="#__codelineno-28-6" id="__codelineno-28-6" name="__codelineno-28-6"></a>        <span class="bp">self</span><span class="p">,</span> 
</span><span id="__span-28-7"><a href="#__codelineno-28-7" id="__codelineno-28-7" name="__codelineno-28-7"></a>        <span class="n">messages</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Message</span><span class="p">],</span> 
</span><span id="__span-28-8"><a href="#__codelineno-28-8" id="__codelineno-28-8" name="__codelineno-28-8"></a>        <span class="n">config</span><span class="p">:</span> <span class="n">AgentConfig</span>
</span><span id="__span-28-9"><a href="#__codelineno-28-9" id="__codelineno-28-9" name="__codelineno-28-9"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LLMResponse</span><span class="p">:</span>
</span><span id="__span-28-10"><a href="#__codelineno-28-10" id="__codelineno-28-10" name="__codelineno-28-10"></a>        <span class="c1"># Custom LLM API call</span>
</span><span id="__span-28-11"><a href="#__codelineno-28-11" id="__codelineno-28-11" name="__codelineno-28-11"></a>        <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_custom_api</span><span class="p">(</span><span class="n">messages</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span>
</span><span id="__span-28-12"><a href="#__codelineno-28-12" id="__codelineno-28-12" name="__codelineno-28-12"></a>        <span class="k">return</span> <span class="n">LLMResponse</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">response</span><span class="p">)</span>
</span><span id="__span-28-13"><a href="#__codelineno-28-13" id="__codelineno-28-13" name="__codelineno-28-13"></a>
</span><span id="__span-28-14"><a href="#__codelineno-28-14" id="__codelineno-28-14" name="__codelineno-28-14"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">chat</span><span class="p">(</span>
</span><span id="__span-28-15"><a href="#__codelineno-28-15" id="__codelineno-28-15" name="__codelineno-28-15"></a>        <span class="bp">self</span><span class="p">,</span> 
</span><span id="__span-28-16"><a href="#__codelineno-28-16" id="__codelineno-28-16" name="__codelineno-28-16"></a>        <span class="n">messages</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Message</span><span class="p">],</span> 
</span><span id="__span-28-17"><a href="#__codelineno-28-17" id="__codelineno-28-17" name="__codelineno-28-17"></a>        <span class="n">config</span><span class="p">:</span> <span class="n">AgentConfig</span>
</span><span id="__span-28-18"><a href="#__codelineno-28-18" id="__codelineno-28-18" name="__codelineno-28-18"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LLMResponse</span><span class="p">:</span>
</span><span id="__span-28-19"><a href="#__codelineno-28-19" id="__codelineno-28-19" name="__codelineno-28-19"></a>        <span class="c1"># Synchronous version</span>
</span><span id="__span-28-20"><a href="#__codelineno-28-20" id="__codelineno-28-20" name="__codelineno-28-20"></a>        <span class="k">return</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chat_async</span><span class="p">(</span><span class="n">messages</span><span class="p">,</span> <span class="n">config</span><span class="p">))</span>
</span></code></pre></div> <ol> <li>Register with factory:</li> </ol> <div class="language-python highlight"><pre><span></span><code><span id="__span-29-1"><a href="#__codelineno-29-1" id="__codelineno-29-1" name="__codelineno-29-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">agent_core.providers.llm_provider_factory</span><span class="w"> </span><span class="kn">import</span> <span class="n">LLMProviderFactory</span>
</span><span id="__span-29-2"><a href="#__codelineno-29-2" id="__codelineno-29-2" name="__codelineno-29-2"></a>
</span><span id="__span-29-3"><a href="#__codelineno-29-3" id="__codelineno-29-3" name="__codelineno-29-3"></a><span class="n">LLMProviderFactory</span><span class="o">.</span><span class="n">register_provider</span><span class="p">(</span><span class="s2">"custom"</span><span class="p">,</span> <span class="n">CustomLLMProvider</span><span class="p">)</span>
</span></code></pre></div> <ol> <li>Use in agent config:</li> </ol> <div class="language-yaml highlight"><pre><span></span><code><span id="__span-30-1"><a href="#__codelineno-30-1" id="__codelineno-30-1" name="__codelineno-30-1"></a><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CustomAgent</span>
</span><span id="__span-30-2"><a href="#__codelineno-30-2" id="__codelineno-30-2" name="__codelineno-30-2"></a><span class="nt">provider</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">custom</span>
</span><span id="__span-30-3"><a href="#__codelineno-30-3" id="__codelineno-30-3" name="__codelineno-30-3"></a><span class="nt">model</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">custom-model-name</span>
</span></code></pre></div> <h2 id="workflow-examples">Workflow Examples<a class="headerlink" href="#workflow-examples" title="Permanent link">¶</a></h2> <h3 id="simple-agent-execution">Simple Agent Execution<a class="headerlink" href="#simple-agent-execution" title="Permanent link">¶</a></h3> <div class="language-python highlight"><pre><span></span><code><span id="__span-31-1"><a href="#__codelineno-31-1" id="__codelineno-31-1" name="__codelineno-31-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">agent_core.agents.agent_factory</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_agent_factory</span>
</span><span id="__span-31-2"><a href="#__codelineno-31-2" id="__codelineno-31-2" name="__codelineno-31-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">agent_core.agents.base_agent</span><span class="w"> </span><span class="kn">import</span> <span class="n">AgentInput</span>
</span><span id="__span-31-3"><a href="#__codelineno-31-3" id="__codelineno-31-3" name="__codelineno-31-3"></a>
</span><span id="__span-31-4"><a href="#__codelineno-31-4" id="__codelineno-31-4" name="__codelineno-31-4"></a><span class="n">factory</span> <span class="o">=</span> <span class="n">get_agent_factory</span><span class="p">()</span>
</span><span id="__span-31-5"><a href="#__codelineno-31-5" id="__codelineno-31-5" name="__codelineno-31-5"></a><span class="n">agent</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">create_agent</span><span class="p">(</span><span class="s2">"GeneralAgent"</span><span class="p">)</span>
</span><span id="__span-31-6"><a href="#__codelineno-31-6" id="__codelineno-31-6" name="__codelineno-31-6"></a>
</span><span id="__span-31-7"><a href="#__codelineno-31-7" id="__codelineno-31-7" name="__codelineno-31-7"></a><span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="n">agent</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">AgentInput</span><span class="p">(</span>
</span><span id="__span-31-8"><a href="#__codelineno-31-8" id="__codelineno-31-8" name="__codelineno-31-8"></a>    <span class="n">query</span><span class="o">=</span><span class="s2">"What is Python?"</span><span class="p">,</span>
</span><span id="__span-31-9"><a href="#__codelineno-31-9" id="__codelineno-31-9" name="__codelineno-31-9"></a>    <span class="n">conversation_history</span><span class="o">=</span><span class="p">[],</span>
</span><span id="__span-31-10"><a href="#__codelineno-31-10" id="__codelineno-31-10" name="__codelineno-31-10"></a>    <span class="n">context</span><span class="o">=</span><span class="p">{}</span>
</span><span id="__span-31-11"><a href="#__codelineno-31-11" id="__codelineno-31-11" name="__codelineno-31-11"></a><span class="p">))</span>
</span><span id="__span-31-12"><a href="#__codelineno-31-12" id="__codelineno-31-12" name="__codelineno-31-12"></a>
</span><span id="__span-31-13"><a href="#__codelineno-31-13" id="__codelineno-31-13" name="__codelineno-31-13"></a><span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">message</span><span class="p">)</span>
</span></code></pre></div> <h3 id="rag-enabled-agent">RAG-Enabled Agent<a class="headerlink" href="#rag-enabled-agent" title="Permanent link">¶</a></h3> <div class="language-python highlight"><pre><span></span><code><span id="__span-32-1"><a href="#__codelineno-32-1" id="__codelineno-32-1" name="__codelineno-32-1"></a><span class="c1"># Create agent with RAG enabled</span>
</span><span id="__span-32-2"><a href="#__codelineno-32-2" id="__codelineno-32-2" name="__codelineno-32-2"></a><span class="n">factory</span> <span class="o">=</span> <span class="n">get_agent_factory</span><span class="p">()</span>
</span><span id="__span-32-3"><a href="#__codelineno-32-3" id="__codelineno-32-3" name="__codelineno-32-3"></a><span class="n">agent</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">create_agent</span><span class="p">(</span><span class="s2">"RAGAgent"</span><span class="p">)</span>  <span class="c1"># Assumes RAGAgent config has use_rag: true</span>
</span><span id="__span-32-4"><a href="#__codelineno-32-4" id="__codelineno-32-4" name="__codelineno-32-4"></a>
</span><span id="__span-32-5"><a href="#__codelineno-32-5" id="__codelineno-32-5" name="__codelineno-32-5"></a><span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="n">agent</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">AgentInput</span><span class="p">(</span>
</span><span id="__span-32-6"><a href="#__codelineno-32-6" id="__codelineno-32-6" name="__codelineno-32-6"></a>    <span class="n">query</span><span class="o">=</span><span class="s2">"How to configure OAuth?"</span><span class="p">,</span>
</span><span id="__span-32-7"><a href="#__codelineno-32-7" id="__codelineno-32-7" name="__codelineno-32-7"></a>    <span class="n">context</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-32-8"><a href="#__codelineno-32-8" id="__codelineno-32-8" name="__codelineno-32-8"></a>        <span class="s2">"rag_category"</span><span class="p">:</span> <span class="s2">"Security"</span><span class="p">,</span>
</span><span id="__span-32-9"><a href="#__codelineno-32-9" id="__codelineno-32-9" name="__codelineno-32-9"></a>        <span class="s2">"knowledge_ids"</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
</span><span id="__span-32-10"><a href="#__codelineno-32-10" id="__codelineno-32-10" name="__codelineno-32-10"></a>    <span class="p">}</span>
</span><span id="__span-32-11"><a href="#__codelineno-32-11" id="__codelineno-32-11" name="__codelineno-32-11"></a><span class="p">))</span>
</span><span id="__span-32-12"><a href="#__codelineno-32-12" id="__codelineno-32-12" name="__codelineno-32-12"></a>
</span><span id="__span-32-13"><a href="#__codelineno-32-13" id="__codelineno-32-13" name="__codelineno-32-13"></a><span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">message</span><span class="p">)</span>
</span><span id="__span-32-14"><a href="#__codelineno-32-14" id="__codelineno-32-14" name="__codelineno-32-14"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Used </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">context_used</span><span class="p">)</span><span class="si">}</span><span class="s2"> context documents"</span><span class="p">)</span>
</span><span id="__span-32-15"><a href="#__codelineno-32-15" id="__codelineno-32-15" name="__codelineno-32-15"></a><span class="k">for</span> <span class="n">ctx</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">context_used</span><span class="p">:</span>
</span><span id="__span-32-16"><a href="#__codelineno-32-16" id="__codelineno-32-16" name="__codelineno-32-16"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"  - </span><span class="si">{</span><span class="n">ctx</span><span class="p">[</span><span class="s1">'title'</span><span class="p">]</span><span class="si">}</span><span class="s2"> (score: </span><span class="si">{</span><span class="n">ctx</span><span class="p">[</span><span class="s1">'score'</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">)"</span><span class="p">)</span>
</span></code></pre></div> <h3 id="router-with-custom-agents">Router with Custom Agents<a class="headerlink" href="#router-with-custom-agents" title="Permanent link">¶</a></h3> <div class="language-python highlight"><pre><span></span><code><span id="__span-33-1"><a href="#__codelineno-33-1" id="__codelineno-33-1" name="__codelineno-33-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">agent_core.agents.agent_router</span><span class="w"> </span><span class="kn">import</span> <span class="n">AgentRouter</span>
</span><span id="__span-33-2"><a href="#__codelineno-33-2" id="__codelineno-33-2" name="__codelineno-33-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">agent_core.agents.query_classifier</span><span class="w"> </span><span class="kn">import</span> <span class="n">QueryIntent</span>
</span><span id="__span-33-3"><a href="#__codelineno-33-3" id="__codelineno-33-3" name="__codelineno-33-3"></a>
</span><span id="__span-33-4"><a href="#__codelineno-33-4" id="__codelineno-33-4" name="__codelineno-33-4"></a><span class="c1"># Create custom agents</span>
</span><span id="__span-33-5"><a href="#__codelineno-33-5" id="__codelineno-33-5" name="__codelineno-33-5"></a><span class="n">factory</span> <span class="o">=</span> <span class="n">get_agent_factory</span><span class="p">()</span>
</span><span id="__span-33-6"><a href="#__codelineno-33-6" id="__codelineno-33-6" name="__codelineno-33-6"></a><span class="n">custom_agent</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">create_agent</span><span class="p">(</span><span class="s2">"MyCustomAgent"</span><span class="p">)</span>
</span><span id="__span-33-7"><a href="#__codelineno-33-7" id="__codelineno-33-7" name="__codelineno-33-7"></a>
</span><span id="__span-33-8"><a href="#__codelineno-33-8" id="__codelineno-33-8" name="__codelineno-33-8"></a><span class="c1"># Create router</span>
</span><span id="__span-33-9"><a href="#__codelineno-33-9" id="__codelineno-33-9" name="__codelineno-33-9"></a><span class="n">router</span> <span class="o">=</span> <span class="n">AgentRouter</span><span class="p">()</span>
</span><span id="__span-33-10"><a href="#__codelineno-33-10" id="__codelineno-33-10" name="__codelineno-33-10"></a>
</span><span id="__span-33-11"><a href="#__codelineno-33-11" id="__codelineno-33-11" name="__codelineno-33-11"></a><span class="c1"># Register custom agent</span>
</span><span id="__span-33-12"><a href="#__codelineno-33-12" id="__codelineno-33-12" name="__codelineno-33-12"></a><span class="n">router</span><span class="o">.</span><span class="n">register_agent</span><span class="p">(</span><span class="s2">"custom"</span><span class="p">,</span> <span class="n">custom_agent</span><span class="p">)</span>
</span><span id="__span-33-13"><a href="#__codelineno-33-13" id="__codelineno-33-13" name="__codelineno-33-13"></a>
</span><span id="__span-33-14"><a href="#__codelineno-33-14" id="__codelineno-33-14" name="__codelineno-33-14"></a><span class="c1"># Map intent to agent</span>
</span><span id="__span-33-15"><a href="#__codelineno-33-15" id="__codelineno-33-15" name="__codelineno-33-15"></a><span class="n">router</span><span class="o">.</span><span class="n">add_intent_mapping</span><span class="p">(</span><span class="n">QueryIntent</span><span class="o">.</span><span class="n">CUSTOM_INTENT</span><span class="p">,</span> <span class="s2">"custom"</span><span class="p">)</span>
</span><span id="__span-33-16"><a href="#__codelineno-33-16" id="__codelineno-33-16" name="__codelineno-33-16"></a>
</span><span id="__span-33-17"><a href="#__codelineno-33-17" id="__codelineno-33-17" name="__codelineno-33-17"></a><span class="c1"># Route query</span>
</span><span id="__span-33-18"><a href="#__codelineno-33-18" id="__codelineno-33-18" name="__codelineno-33-18"></a><span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="n">router</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s2">"Custom query here"</span><span class="p">)</span>
</span></code></pre></div> <h3 id="context-aware-agent">Context-Aware Agent<a class="headerlink" href="#context-aware-agent" title="Permanent link">¶</a></h3> <div class="language-python highlight"><pre><span></span><code><span id="__span-34-1"><a href="#__codelineno-34-1" id="__codelineno-34-1" name="__codelineno-34-1"></a><span class="n">agent</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">create_agent</span><span class="p">(</span><span class="s2">"GeneralAgent"</span><span class="p">)</span>
</span><span id="__span-34-2"><a href="#__codelineno-34-2" id="__codelineno-34-2" name="__codelineno-34-2"></a>
</span><span id="__span-34-3"><a href="#__codelineno-34-3" id="__codelineno-34-3" name="__codelineno-34-3"></a><span class="c1"># Pass context for prompt templating</span>
</span><span id="__span-34-4"><a href="#__codelineno-34-4" id="__codelineno-34-4" name="__codelineno-34-4"></a><span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="n">agent</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">AgentInput</span><span class="p">(</span>
</span><span id="__span-34-5"><a href="#__codelineno-34-5" id="__codelineno-34-5" name="__codelineno-34-5"></a>    <span class="n">query</span><span class="o">=</span><span class="s2">"Help me with this task"</span><span class="p">,</span>
</span><span id="__span-34-6"><a href="#__codelineno-34-6" id="__codelineno-34-6" name="__codelineno-34-6"></a>    <span class="n">context</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-34-7"><a href="#__codelineno-34-7" id="__codelineno-34-7" name="__codelineno-34-7"></a>        <span class="s2">"role"</span><span class="p">:</span> <span class="s2">"senior engineer"</span><span class="p">,</span>
</span><span id="__span-34-8"><a href="#__codelineno-34-8" id="__codelineno-34-8" name="__codelineno-34-8"></a>        <span class="s2">"task_name"</span><span class="p">:</span> <span class="s2">"Implement authentication"</span><span class="p">,</span>
</span><span id="__span-34-9"><a href="#__codelineno-34-9" id="__codelineno-34-9" name="__codelineno-34-9"></a>        <span class="s2">"priority"</span><span class="p">:</span> <span class="s2">"high"</span><span class="p">,</span>
</span><span id="__span-34-10"><a href="#__codelineno-34-10" id="__codelineno-34-10" name="__codelineno-34-10"></a>        <span class="s2">"deadline"</span><span class="p">:</span> <span class="s2">"2026-02-01"</span>
</span><span id="__span-34-11"><a href="#__codelineno-34-11" id="__codelineno-34-11" name="__codelineno-34-11"></a>    <span class="p">}</span>
</span><span id="__span-34-12"><a href="#__codelineno-34-12" id="__codelineno-34-12" name="__codelineno-34-12"></a><span class="p">))</span>
</span><span id="__span-34-13"><a href="#__codelineno-34-13" id="__codelineno-34-13" name="__codelineno-34-13"></a>
</span><span id="__span-34-14"><a href="#__codelineno-34-14" id="__codelineno-34-14" name="__codelineno-34-14"></a><span class="c1"># System prompt will substitute {role}, {task_name}, etc.</span>
</span></code></pre></div> <h2 id="testing">Testing<a class="headerlink" href="#testing" title="Permanent link">¶</a></h2> <h3 id="unit-testing-agents">Unit Testing Agents<a class="headerlink" href="#unit-testing-agents" title="Permanent link">¶</a></h3> <div class="language-python highlight"><pre><span></span><code><span id="__span-35-1"><a href="#__codelineno-35-1" id="__codelineno-35-1" name="__codelineno-35-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">pytest</span>
</span><span id="__span-35-2"><a href="#__codelineno-35-2" id="__codelineno-35-2" name="__codelineno-35-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">agent_core.agents.agent_factory</span><span class="w"> </span><span class="kn">import</span> <span class="n">AgentFactory</span>
</span><span id="__span-35-3"><a href="#__codelineno-35-3" id="__codelineno-35-3" name="__codelineno-35-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">agent_core.agents.base_agent</span><span class="w"> </span><span class="kn">import</span> <span class="n">AgentInput</span>
</span><span id="__span-35-4"><a href="#__codelineno-35-4" id="__codelineno-35-4" name="__codelineno-35-4"></a>
</span><span id="__span-35-5"><a href="#__codelineno-35-5" id="__codelineno-35-5" name="__codelineno-35-5"></a><span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">asyncio</span>
</span><span id="__span-35-6"><a href="#__codelineno-35-6" id="__codelineno-35-6" name="__codelineno-35-6"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">test_custom_agent</span><span class="p">():</span>
</span><span id="__span-35-7"><a href="#__codelineno-35-7" id="__codelineno-35-7" name="__codelineno-35-7"></a>    <span class="n">factory</span> <span class="o">=</span> <span class="n">AgentFactory</span><span class="p">()</span>
</span><span id="__span-35-8"><a href="#__codelineno-35-8" id="__codelineno-35-8" name="__codelineno-35-8"></a>    <span class="n">agent</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">create_agent</span><span class="p">(</span><span class="s2">"MyCustomAgent"</span><span class="p">)</span>
</span><span id="__span-35-9"><a href="#__codelineno-35-9" id="__codelineno-35-9" name="__codelineno-35-9"></a>
</span><span id="__span-35-10"><a href="#__codelineno-35-10" id="__codelineno-35-10" name="__codelineno-35-10"></a>    <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="n">agent</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">AgentInput</span><span class="p">(</span>
</span><span id="__span-35-11"><a href="#__codelineno-35-11" id="__codelineno-35-11" name="__codelineno-35-11"></a>        <span class="n">query</span><span class="o">=</span><span class="s2">"Test query"</span><span class="p">,</span>
</span><span id="__span-35-12"><a href="#__codelineno-35-12" id="__codelineno-35-12" name="__codelineno-35-12"></a>        <span class="n">context</span><span class="o">=</span><span class="p">{</span><span class="s2">"domain"</span><span class="p">:</span> <span class="s2">"testing"</span><span class="p">}</span>
</span><span id="__span-35-13"><a href="#__codelineno-35-13" id="__codelineno-35-13" name="__codelineno-35-13"></a>    <span class="p">))</span>
</span><span id="__span-35-14"><a href="#__codelineno-35-14" id="__codelineno-35-14" name="__codelineno-35-14"></a>
</span><span id="__span-35-15"><a href="#__codelineno-35-15" id="__codelineno-35-15" name="__codelineno-35-15"></a>    <span class="k">assert</span> <span class="n">response</span><span class="o">.</span><span class="n">message</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="__span-35-16"><a href="#__codelineno-35-16" id="__codelineno-35-16" name="__codelineno-35-16"></a>    <span class="k">assert</span> <span class="n">response</span><span class="o">.</span><span class="n">agent_type</span> <span class="o">==</span> <span class="s2">"my_custom"</span>
</span></code></pre></div> <h3 id="testing-router">Testing Router<a class="headerlink" href="#testing-router" title="Permanent link">¶</a></h3> <div class="language-python highlight"><pre><span></span><code><span id="__span-36-1"><a href="#__codelineno-36-1" id="__codelineno-36-1" name="__codelineno-36-1"></a><span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">asyncio</span>
</span><span id="__span-36-2"><a href="#__codelineno-36-2" id="__codelineno-36-2" name="__codelineno-36-2"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">test_router_routing</span><span class="p">():</span>
</span><span id="__span-36-3"><a href="#__codelineno-36-3" id="__codelineno-36-3" name="__codelineno-36-3"></a>    <span class="n">router</span> <span class="o">=</span> <span class="n">AgentRouter</span><span class="p">()</span>
</span><span id="__span-36-4"><a href="#__codelineno-36-4" id="__codelineno-36-4" name="__codelineno-36-4"></a>
</span><span id="__span-36-5"><a href="#__codelineno-36-5" id="__codelineno-36-5" name="__codelineno-36-5"></a>    <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="n">router</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s2">"How do I implement OAuth?"</span><span class="p">)</span>
</span><span id="__span-36-6"><a href="#__codelineno-36-6" id="__codelineno-36-6" name="__codelineno-36-6"></a>
</span><span id="__span-36-7"><a href="#__codelineno-36-7" id="__codelineno-36-7" name="__codelineno-36-7"></a>    <span class="k">assert</span> <span class="n">response</span><span class="o">.</span><span class="n">intent</span> <span class="o">==</span> <span class="n">QueryIntent</span><span class="o">.</span><span class="n">CODE_HELP</span>
</span><span id="__span-36-8"><a href="#__codelineno-36-8" id="__codelineno-36-8" name="__codelineno-36-8"></a>    <span class="k">assert</span> <span class="n">response</span><span class="o">.</span><span class="n">agent_type</span> <span class="o">==</span> <span class="s2">"code_help"</span>
</span><span id="__span-36-9"><a href="#__codelineno-36-9" id="__codelineno-36-9" name="__codelineno-36-9"></a>    <span class="k">assert</span> <span class="n">response</span><span class="o">.</span><span class="n">confidence</span> <span class="o">&gt;</span> <span class="mf">0.7</span>
</span></code></pre></div> <h3 id="mocking-rag-service">Mocking RAG Service<a class="headerlink" href="#mocking-rag-service" title="Permanent link">¶</a></h3> <div class="language-python highlight"><pre><span></span><code><span id="__span-37-1"><a href="#__codelineno-37-1" id="__codelineno-37-1" name="__codelineno-37-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">unittest.mock</span><span class="w"> </span><span class="kn">import</span> <span class="n">AsyncMock</span><span class="p">,</span> <span class="n">patch</span>
</span><span id="__span-37-2"><a href="#__codelineno-37-2" id="__codelineno-37-2" name="__codelineno-37-2"></a>
</span><span id="__span-37-3"><a href="#__codelineno-37-3" id="__codelineno-37-3" name="__codelineno-37-3"></a><span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">asyncio</span>
</span><span id="__span-37-4"><a href="#__codelineno-37-4" id="__codelineno-37-4" name="__codelineno-37-4"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">test_agent_with_rag</span><span class="p">():</span>
</span><span id="__span-37-5"><a href="#__codelineno-37-5" id="__codelineno-37-5" name="__codelineno-37-5"></a>    <span class="k">with</span> <span class="n">patch</span><span class="p">(</span><span class="s1">'agent_core.agents.base_agent.RAGService'</span><span class="p">)</span> <span class="k">as</span> <span class="n">mock_rag</span><span class="p">:</span>
</span><span id="__span-37-6"><a href="#__codelineno-37-6" id="__codelineno-37-6" name="__codelineno-37-6"></a>        <span class="n">mock_rag</span><span class="o">.</span><span class="n">return_value</span><span class="o">.</span><span class="n">search</span> <span class="o">=</span> <span class="n">AsyncMock</span><span class="p">(</span><span class="n">return_value</span><span class="o">=</span><span class="p">[</span>
</span><span id="__span-37-7"><a href="#__codelineno-37-7" id="__codelineno-37-7" name="__codelineno-37-7"></a>            <span class="p">{</span>
</span><span id="__span-37-8"><a href="#__codelineno-37-8" id="__codelineno-37-8" name="__codelineno-37-8"></a>                <span class="s2">"content"</span><span class="p">:</span> <span class="s2">"Test content"</span><span class="p">,</span>
</span><span id="__span-37-9"><a href="#__codelineno-37-9" id="__codelineno-37-9" name="__codelineno-37-9"></a>                <span class="s2">"title"</span><span class="p">:</span> <span class="s2">"Test Doc"</span><span class="p">,</span>
</span><span id="__span-37-10"><a href="#__codelineno-37-10" id="__codelineno-37-10" name="__codelineno-37-10"></a>                <span class="s2">"uri"</span><span class="p">:</span> <span class="s2">"/test.md"</span><span class="p">,</span>
</span><span id="__span-37-11"><a href="#__codelineno-37-11" id="__codelineno-37-11" name="__codelineno-37-11"></a>                <span class="s2">"score"</span><span class="p">:</span> <span class="mf">0.9</span><span class="p">,</span>
</span><span id="__span-37-12"><a href="#__codelineno-37-12" id="__codelineno-37-12" name="__codelineno-37-12"></a>                <span class="s2">"knowledge_id"</span><span class="p">:</span> <span class="mi">1</span>
</span><span id="__span-37-13"><a href="#__codelineno-37-13" id="__codelineno-37-13" name="__codelineno-37-13"></a>            <span class="p">}</span>
</span><span id="__span-37-14"><a href="#__codelineno-37-14" id="__codelineno-37-14" name="__codelineno-37-14"></a>        <span class="p">])</span>
</span><span id="__span-37-15"><a href="#__codelineno-37-15" id="__codelineno-37-15" name="__codelineno-37-15"></a>
</span><span id="__span-37-16"><a href="#__codelineno-37-16" id="__codelineno-37-16" name="__codelineno-37-16"></a>        <span class="n">agent</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">create_agent</span><span class="p">(</span><span class="s2">"RAGAgent"</span><span class="p">)</span>
</span><span id="__span-37-17"><a href="#__codelineno-37-17" id="__codelineno-37-17" name="__codelineno-37-17"></a>        <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="n">agent</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">AgentInput</span><span class="p">(</span>
</span><span id="__span-37-18"><a href="#__codelineno-37-18" id="__codelineno-37-18" name="__codelineno-37-18"></a>            <span class="n">query</span><span class="o">=</span><span class="s2">"Test query"</span><span class="p">,</span>
</span><span id="__span-37-19"><a href="#__codelineno-37-19" id="__codelineno-37-19" name="__codelineno-37-19"></a>            <span class="n">use_rag</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-37-20"><a href="#__codelineno-37-20" id="__codelineno-37-20" name="__codelineno-37-20"></a>        <span class="p">))</span>
</span><span id="__span-37-21"><a href="#__codelineno-37-21" id="__codelineno-37-21" name="__codelineno-37-21"></a>
</span><span id="__span-37-22"><a href="#__codelineno-37-22" id="__codelineno-37-22" name="__codelineno-37-22"></a>        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">context_used</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>
</span></code></pre></div> <h2 id="best-practices">Best Practices<a class="headerlink" href="#best-practices" title="Permanent link">¶</a></h2> <h3 id="agent-design">Agent Design<a class="headerlink" href="#agent-design" title="Permanent link">¶</a></h3> <ol> <li><strong>Use generic agents when possible</strong>: YAML-only agents are easier to maintain and modify</li> <li><strong>Keep custom logic minimal</strong>: Override only necessary methods</li> <li><strong>Leverage context</strong>: Use context dict for prompt templating and RAG filtering</li> <li><strong>Handle errors gracefully</strong>: Return meaningful error messages in responses</li> </ol> <h3 id="configuration-management">Configuration Management<a class="headerlink" href="#configuration-management" title="Permanent link">¶</a></h3> <ol> <li><strong>Use environment variables</strong>: For sensitive data like API keys</li> <li><strong>Version control configs</strong>: Keep agent YAML files in version control</li> <li><strong>Document prompts</strong>: Add comments in prompt.md explaining the agent's purpose</li> <li><strong>Test configurations</strong>: Validate agent configs before deployment</li> </ol> <h3 id="rag-integration_1">RAG Integration<a class="headerlink" href="#rag-integration_1" title="Permanent link">¶</a></h3> <ol> <li><strong>Filter appropriately</strong>: Use category and knowledge_ids to narrow search</li> <li><strong>Tune top_k</strong>: Balance between context and noise</li> <li><strong>Monitor scores</strong>: Log RAG scores to improve retrieval</li> <li><strong>Update regularly</strong>: Re-index documents when content changes</li> </ol> <h3 id="performance">Performance<a class="headerlink" href="#performance" title="Permanent link">¶</a></h3> <ol> <li><strong>Cache agents</strong>: Reuse agent instances when possible</li> <li><strong>Async operations</strong>: Use async/await for I/O operations</li> <li><strong>Batch RAG queries</strong>: When processing multiple queries</li> <li><strong>Monitor LLM calls</strong>: Track token usage and latency</li> </ol> <h2 id="troubleshooting">Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permanent link">¶</a></h2> <h3 id="agent-not-found">Agent Not Found<a class="headerlink" href="#agent-not-found" title="Permanent link">¶</a></h3> <p><strong>Error</strong>: <code>ValueError: Unknown agent: MyAgent</code></p> <p><strong>Solution</strong>: - Check agent name matches directory name - Verify <code>agent.yaml</code> exists in agent directory - Ensure factory is loading from correct config directory</p> <h3 id="class-import-error">Class Import Error<a class="headerlink" href="#class-import-error" title="Permanent link">¶</a></h3> <p><strong>Error</strong>: <code>ValueError: Failed to import agent class 'my_module.MyAgent'</code></p> <p><strong>Solution</strong>: - Verify fully qualified class name is correct - Ensure module is in Python path - Check class extends <code>BaseAgent</code></p> <h3 id="rag-not-working">RAG Not Working<a class="headerlink" href="#rag-not-working" title="Permanent link">¶</a></h3> <p><strong>Error</strong>: No context retrieved despite <code>use_rag=True</code></p> <p><strong>Solution</strong>: - Verify RAG service is initialized - Check vector store has indexed documents - Verify category/knowledge_ids filters are correct - Check RAG service logs for errors</p> <h3 id="prompt-not-loading">Prompt Not Loading<a class="headerlink" href="#prompt-not-loading" title="Permanent link">¶</a></h3> <p><strong>Error</strong>: Agent uses default prompt instead of custom</p> <p><strong>Solution</strong>: - Verify <code>prompt.md</code> exists in agent directory - Check file encoding (should be UTF-8) - Ensure agent_dir is set correctly in config</p> <h2 id="api-reference">API Reference<a class="headerlink" href="#api-reference" title="Permanent link">¶</a></h2> <h3 id="factory-functions">Factory Functions<a class="headerlink" href="#factory-functions" title="Permanent link">¶</a></h3> <div class="language-python highlight"><pre><span></span><code><span id="__span-38-1"><a href="#__codelineno-38-1" id="__codelineno-38-1" name="__codelineno-38-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">agent_core.agents.agent_factory</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="__span-38-2"><a href="#__codelineno-38-2" id="__codelineno-38-2" name="__codelineno-38-2"></a>    <span class="n">AgentFactory</span><span class="p">,</span>
</span><span id="__span-38-3"><a href="#__codelineno-38-3" id="__codelineno-38-3" name="__codelineno-38-3"></a>    <span class="n">AgentConfig</span><span class="p">,</span>
</span><span id="__span-38-4"><a href="#__codelineno-38-4" id="__codelineno-38-4" name="__codelineno-38-4"></a>    <span class="n">get_agent_factory</span><span class="p">,</span>
</span><span id="__span-38-5"><a href="#__codelineno-38-5" id="__codelineno-38-5" name="__codelineno-38-5"></a>    <span class="n">reset_agent_factory</span>
</span><span id="__span-38-6"><a href="#__codelineno-38-6" id="__codelineno-38-6" name="__codelineno-38-6"></a><span class="p">)</span>
</span></code></pre></div> <h3 id="agent-classes">Agent Classes<a class="headerlink" href="#agent-classes" title="Permanent link">¶</a></h3> <div class="language-python highlight"><pre><span></span><code><span id="__span-39-1"><a href="#__codelineno-39-1" id="__codelineno-39-1" name="__codelineno-39-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">agent_core.agents.base_agent</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="__span-39-2"><a href="#__codelineno-39-2" id="__codelineno-39-2" name="__codelineno-39-2"></a>    <span class="n">BaseAgent</span><span class="p">,</span>
</span><span id="__span-39-3"><a href="#__codelineno-39-3" id="__codelineno-39-3" name="__codelineno-39-3"></a>    <span class="n">AgentInput</span><span class="p">,</span>
</span><span id="__span-39-4"><a href="#__codelineno-39-4" id="__codelineno-39-4" name="__codelineno-39-4"></a>    <span class="n">AgentResponse</span>
</span><span id="__span-39-5"><a href="#__codelineno-39-5" id="__codelineno-39-5" name="__codelineno-39-5"></a><span class="p">)</span>
</span></code></pre></div> <h3 id="router">Router<a class="headerlink" href="#router" title="Permanent link">¶</a></h3> <div class="language-python highlight"><pre><span></span><code><span id="__span-40-1"><a href="#__codelineno-40-1" id="__codelineno-40-1" name="__codelineno-40-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">agent_core.agents.agent_router</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="__span-40-2"><a href="#__codelineno-40-2" id="__codelineno-40-2" name="__codelineno-40-2"></a>    <span class="n">AgentRouter</span><span class="p">,</span>
</span><span id="__span-40-3"><a href="#__codelineno-40-3" id="__codelineno-40-3" name="__codelineno-40-3"></a>    <span class="n">RoutedResponse</span><span class="p">,</span>
</span><span id="__span-40-4"><a href="#__codelineno-40-4" id="__codelineno-40-4" name="__codelineno-40-4"></a>    <span class="n">WorkflowState</span>
</span><span id="__span-40-5"><a href="#__codelineno-40-5" id="__codelineno-40-5" name="__codelineno-40-5"></a><span class="p">)</span>
</span></code></pre></div> <h3 id="query-classification">Query Classification<a class="headerlink" href="#query-classification" title="Permanent link">¶</a></h3> <div class="language-python highlight"><pre><span></span><code><span id="__span-41-1"><a href="#__codelineno-41-1" id="__codelineno-41-1" name="__codelineno-41-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">agent_core.agents.query_classifier</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="__span-41-2"><a href="#__codelineno-41-2" id="__codelineno-41-2" name="__codelineno-41-2"></a>    <span class="n">QueryClassifier</span><span class="p">,</span>
</span><span id="__span-41-3"><a href="#__codelineno-41-3" id="__codelineno-41-3" name="__codelineno-41-3"></a>    <span class="n">QueryIntent</span><span class="p">,</span>
</span><span id="__span-41-4"><a href="#__codelineno-41-4" id="__codelineno-41-4" name="__codelineno-41-4"></a>    <span class="n">ClassificationResult</span>
</span><span id="__span-41-5"><a href="#__codelineno-41-5" id="__codelineno-41-5" name="__codelineno-41-5"></a><span class="p">)</span>
</span></code></pre></div> <h3 id="rag-service">RAG Service<a class="headerlink" href="#rag-service" title="Permanent link">¶</a></h3> <div class="language-python highlight"><pre><span></span><code><span id="__span-42-1"><a href="#__codelineno-42-1" id="__codelineno-42-1" name="__codelineno-42-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">agent_core.services.rag.service</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="__span-42-2"><a href="#__codelineno-42-2" id="__codelineno-42-2" name="__codelineno-42-2"></a>    <span class="n">RAGService</span><span class="p">,</span>
</span><span id="__span-42-3"><a href="#__codelineno-42-3" id="__codelineno-42-3" name="__codelineno-42-3"></a>    <span class="n">get_rag_service</span><span class="p">,</span>
</span><span id="__span-42-4"><a href="#__codelineno-42-4" id="__codelineno-42-4" name="__codelineno-42-4"></a>    <span class="n">SearchResult</span><span class="p">,</span>
</span><span id="__span-42-5"><a href="#__codelineno-42-5" id="__codelineno-42-5" name="__codelineno-42-5"></a>    <span class="n">IndexingResult</span>
</span><span id="__span-42-6"><a href="#__codelineno-42-6" id="__codelineno-42-6" name="__codelineno-42-6"></a><span class="p">)</span>
</span></code></pre></div> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button class="md-top md-icon" data-md-component="top" hidden="" type="button"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg> Back to top </button> </main> <footer class="md-footer"> <nav aria-label="Footer" class="md-footer__inner md-grid"> <a aria-label="Previous: Assets" class="md-footer__link md-footer__link--prev" href="../assets/"> <div class="md-footer__button md-icon"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg> </div> <div class="md-footer__title"> <span class="md-footer__direction"> Previous </span> <div class="md-ellipsis"> Assets </div> </div> </a> <a aria-label="Next: Agent mgt" class="md-footer__link md-footer__link--next" href="../agents/"> <div class="md-footer__title"> <span class="md-footer__direction"> Next </span> <div class="md-ellipsis"> Agent mgt </div> </div> <div class="md-footer__button md-icon"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"></path></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class="md-copyright"> <div class="md-copyright__highlight"> Copyright © 2025 - 2026 Jerome Boyer </div> Made with <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank"> Material for MkDocs </a> </div> <div class="md-social"> <a class="md-social__link" href="https://github.com/jbcodeforce/myaiassistant" rel="noopener" target="_blank" title="github.com"> <svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg> </a> <a class="md-social__link" href="https://linkedin.com/in/jeromeboyer" rel="noopener" target="_blank" title="linkedin.com"> <svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"></path></svg> </a> </div> </div> </div> </footer> </div> <div class="md-dialog" data-md-component="dialog"> <div class="md-dialog__inner md-typeset"></div> </div> <div class="md-progress" data-md-component="progress" role="progressbar"></div> <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.sections", "navigation.expand", "content.code.annotate", "content.code.annotation", "content.code.copy", "content.tooltips", "content.tabs.link", "search.suggest", "search.highlight", "navigation.instant", "navigation.instant.progress", "navigation.tabs", "navigation.tabs.sticky", "navigation.tracking", "navigation.sections", "navigation.expand", "navigation.top", "navigation.footer"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script> <script type="module">import mermaid from "https://unpkg.com/mermaid@10.4.0/dist/mermaid.esm.min.mjs";
window.mermaidConfig = {default: {
    startOnLoad: false
}};</script></body> </html>